<template><div><h2 id="å®¹å™¨ä¸-bean" tabindex="-1"><a class="header-anchor" href="#å®¹å™¨ä¸-bean"><span>å®¹å™¨ä¸ bean</span></a></h2>
<h3 id="_1-å®¹å™¨æ¥å£" tabindex="-1"><a class="header-anchor" href="#_1-å®¹å™¨æ¥å£"><span>1) å®¹å™¨æ¥å£</span></a></h3>
<ul>
<li>
<p>BeanFactory æ¥å£ï¼Œå…¸å‹åŠŸèƒ½æœ‰ï¼š</p>
<ul>
<li>getBean</li>
</ul>
</li>
<li>
<p>ApplicationContext æ¥å£ï¼Œæ˜¯ BeanFactory çš„å­æ¥å£ã€‚å®ƒæ‰©å±•äº† BeanFactory æ¥å£çš„åŠŸèƒ½ï¼Œå¦‚ï¼š</p>
<ul>
<li>å›½é™…åŒ–</li>
<li>é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æº</li>
<li>æ•´åˆ Environment ç¯å¢ƒï¼ˆèƒ½é€šè¿‡å®ƒè·å–å„ç§æ¥æºçš„é…ç½®ä¿¡æ¯ï¼‰</li>
<li>äº‹ä»¶å‘å¸ƒä¸ç›‘å¬ï¼Œå®ç°ç»„ä»¶ä¹‹é—´çš„è§£è€¦</li>
</ul>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¯¾ä¸Šè®²çš„ï¼Œéƒ½æ˜¯ BeanFactory æä¾›çš„åŸºæœ¬åŠŸèƒ½ï¼ŒApplicationContext ä¸­çš„æ‰©å±•åŠŸèƒ½éƒ½æ²¡æœ‰ç”¨åˆ°ã€‚</p>
<h4 id="æ¼”ç¤º1-beanfactory-ä¸-applicationcontext-çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-beanfactory-ä¸-applicationcontext-çš„åŒºåˆ«"><span>æ¼”ç¤º1 - BeanFactory ä¸ ApplicationContext çš„åŒºåˆ«</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a01</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹ç»“åˆ debug æŸ¥çœ‹ ApplicationContext å¯¹è±¡çš„å†…éƒ¨ç»“æ„ï¼Œå­¦åˆ°ï¼š</p>
<ol>
<li>
<p>åˆ°åº•ä»€ä¹ˆæ˜¯ BeanFactory</p>
<ul>
<li>å®ƒæ˜¯ ApplicationContext çš„çˆ¶æ¥å£</li>
<li>å®ƒæ‰æ˜¯ Spring çš„æ ¸å¿ƒå®¹å™¨, ä¸»è¦çš„ ApplicationContext å®ç°éƒ½ã€ç»„åˆã€‘äº†å®ƒçš„åŠŸèƒ½ï¼Œã€ç»„åˆã€‘æ˜¯æŒ‡ ApplicationContext çš„ä¸€ä¸ªé‡è¦æˆå‘˜å˜é‡å°±æ˜¯ BeanFactory</li>
</ul>
</li>
<li>
<p>BeanFactory èƒ½å¹²ç‚¹å•¥</p>
<ul>
<li>è¡¨é¢ä¸Šåªæœ‰ getBean</li>
<li>å®é™…ä¸Šæ§åˆ¶åè½¬ã€åŸºæœ¬çš„ä¾èµ–æ³¨å…¥ã€ç›´è‡³ Bean çš„ç”Ÿå‘½å‘¨æœŸçš„å„ç§åŠŸèƒ½ï¼Œéƒ½ç”±å®ƒçš„å®ç°ç±»æä¾›</li>
<li>ä¾‹å­ä¸­é€šè¿‡åå°„æŸ¥çœ‹äº†å®ƒçš„æˆå‘˜å˜é‡ singletonObjectsï¼Œå†…éƒ¨åŒ…å«äº†æ‰€æœ‰çš„å•ä¾‹ bean</li>
</ul>
</li>
<li>
<p>ApplicationContext æ¯” BeanFactory å¤šç‚¹å•¥</p>
<ul>
<li>ApplicationContext ç»„åˆå¹¶æ‰©å±•äº† BeanFactory çš„åŠŸèƒ½</li>
<li>å›½é™…åŒ–ã€é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æºã€æ•´åˆ Environment ç¯å¢ƒã€äº‹ä»¶å‘å¸ƒä¸ç›‘å¬</li>
<li>æ–°å­¦ä¸€ç§ä»£ç ä¹‹é—´è§£è€¦é€”å¾„ï¼Œäº‹ä»¶è§£è€¦</li>
</ul>
</li>
</ol>
<p>å»ºè®®ç»ƒä¹ ï¼šå®Œæˆç”¨æˆ·æ³¨å†Œä¸å‘é€çŸ­ä¿¡ä¹‹é—´çš„è§£è€¦ï¼Œç”¨äº‹ä»¶æ–¹å¼ã€å’Œ AOP æ–¹å¼åˆ†åˆ«å®ç°</p>
<blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMEDï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›ç‰ˆæœ¬çš„ jdk é»˜è®¤ä¸å…è®¸è·¨ module åå°„</li>
<li>äº‹ä»¶å‘å¸ƒè¿˜å¯ä»¥å¼‚æ­¥ï¼Œè¿™ä¸ªè§†é¢‘ä¸­æ²¡æœ‰å±•ç¤ºï¼Œè¯·è‡ªè¡ŒæŸ¥é˜… @EnableAsyncï¼Œ@Async çš„ç”¨æ³•</li>
</ul>
</blockquote>
<h4 id="æ¼”ç¤º2-å›½é™…åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-å›½é™…åŒ–"><span>æ¼”ç¤º2 - å›½é™…åŒ–</span></a></h4>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> TestMessageSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        GenericApplicationContext</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> GenericApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">registerBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"messageSource"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MessageSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, () </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            ResourceBundleMessageSource</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ms</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ResourceBundleMessageSource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            ms</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setDefaultEncoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"utf-8"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            ms</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setBasename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"messages"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ms;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">refresh</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"hi"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Locale</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">ENGLISH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"hi"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Locale</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">CHINESE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"hi"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Locale</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">JAPANESE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å›½é™…åŒ–æ–‡ä»¶å‡åœ¨ src/resources ç›®å½•ä¸‹</p>
<p>messages.propertiesï¼ˆç©ºï¼‰</p>
<p>messages_en.properties</p>
<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">hi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">Hello</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>messages_ja.properties</p>
<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">hi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">ã“ã‚“ã«ã¡ã¯</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>messages_zh.properties</p>
<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">hi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">ä½ å¥½</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>ApplicationContext ä¸­ MessageSource bean çš„åå­—å›ºå®šä¸º messageSource</li>
<li>ä½¿ç”¨ SpringBoot æ—¶ï¼Œå›½é™…åŒ–æ–‡ä»¶åå›ºå®šä¸º messages</li>
<li>ç©ºçš„ messages.properties ä¹Ÿå¿…é¡»å­˜åœ¨</li>
</ul>
</blockquote>
<h3 id="_2-å®¹å™¨å®ç°" tabindex="-1"><a class="header-anchor" href="#_2-å®¹å™¨å®ç°"><span>2) å®¹å™¨å®ç°</span></a></h3>
<p>Spring çš„å‘å±•å†å²è¾ƒä¸ºæ‚ ä¹…ï¼Œå› æ­¤å¾ˆå¤šèµ„æ–™è¿˜åœ¨è®²è§£å®ƒè¾ƒæ—§çš„å®ç°ï¼Œè¿™é‡Œå‡ºäºæ€€æ—§çš„åŸå› ï¼ŒæŠŠå®ƒä»¬éƒ½åˆ—å‡ºæ¥ï¼Œä¾›å¤§å®¶å‚è€ƒ</p>
<ul>
<li>DefaultListableBeanFactoryï¼Œæ˜¯ BeanFactory æœ€é‡è¦çš„å®ç°ï¼Œåƒ<strong>æ§åˆ¶åè½¬</strong>å’Œ<strong>ä¾èµ–æ³¨å…¥</strong>åŠŸèƒ½ï¼Œéƒ½æ˜¯å®ƒæ¥å®ç°</li>
<li>ClassPathXmlApplicationContextï¼Œä»ç±»è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li>
<li>FileSystemXmlApplicationContextï¼Œä»ç£ç›˜è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li>
<li>XmlWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº XML é…ç½®æ–‡ä»¶çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li>
<li>AnnotationConfigWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº java é…ç½®ç±»çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li>
<li>AnnotationConfigApplicationContextï¼ŒSpring boot ä¸­é web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li>
<li>AnnotationConfigServletWebServerApplicationContextï¼ŒSpring boot ä¸­ servlet web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li>
<li>AnnotationConfigReactiveWebServerApplicationContextï¼ŒSpring boot ä¸­ reactive web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li>
</ul>
<p>å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œåé¢è¿™äº›å¸¦æœ‰ ApplicationContext çš„ç±»éƒ½æ˜¯ ApplicationContext æ¥å£çš„å®ç°ï¼Œä½†å®ƒä»¬æ˜¯<strong>ç»„åˆ</strong>äº† DefaultListableBeanFactory çš„åŠŸèƒ½ï¼Œå¹¶éç»§æ‰¿è€Œæ¥</p>
<h4 id="æ¼”ç¤º1-defaultlistablebeanfactory" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-defaultlistablebeanfactory"><span>æ¼”ç¤º1 - DefaultListableBeanFactory</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-1" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-1"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a02.TestBeanFactory</strong></p>
<h4 id="æ”¶è·ğŸ’¡-1" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-1"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ul>
<li>beanFactory å¯ä»¥é€šè¿‡ registerBeanDefinition æ³¨å†Œä¸€ä¸ª bean definition å¯¹è±¡
<ul>
<li>æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„é…ç½®ç±»ã€xmlã€ç»„ä»¶æ‰«æç­‰æ–¹å¼éƒ½æ˜¯ç”Ÿæˆ bean definition å¯¹è±¡æ³¨å†Œåˆ° beanFactory å½“ä¸­</li>
<li>bean definition æè¿°äº†è¿™ä¸ª bean çš„åˆ›å»ºè“å›¾ï¼šscope æ˜¯ä»€ä¹ˆã€ç”¨æ„é€ è¿˜æ˜¯å·¥å‚åˆ›å»ºã€åˆå§‹åŒ–é”€æ¯æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œç­‰ç­‰</li>
</ul>
</li>
<li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨ beanFactory åå¤„ç†å™¨å¯¹å®ƒåšå¢å¼º
<ul>
<li>ä¾‹å¦‚é€šè¿‡è§£æ @Beanã€@ComponentScan ç­‰æ³¨è§£ï¼Œæ¥è¡¥å……ä¸€äº› bean definition</li>
</ul>
</li>
<li>beanFactory éœ€è¦æ‰‹åŠ¨æ·»åŠ  bean åå¤„ç†å™¨ï¼Œä»¥ä¾¿å¯¹åç»­ bean çš„åˆ›å»ºè¿‡ç¨‹æä¾›å¢å¼º
<ul>
<li>ä¾‹å¦‚ @Autowiredï¼Œ@Resource ç­‰æ³¨è§£çš„è§£æéƒ½æ˜¯ bean åå¤„ç†å™¨å®Œæˆçš„</li>
<li>bean åå¤„ç†çš„æ·»åŠ é¡ºåºä¼šå¯¹è§£æç»“æœæœ‰å½±å“ï¼Œè§è§†é¢‘ä¸­åŒæ—¶åŠ  @Autowiredï¼Œ@Resource çš„ä¾‹å­</li>
</ul>
</li>
<li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨æ–¹æ³•æ¥åˆå§‹åŒ–å•ä¾‹</li>
<li>beanFactory éœ€è¦é¢å¤–è®¾ç½®æ‰èƒ½è§£æ ${} ä¸ #{}</li>
</ul>
<h4 id="æ¼”ç¤º2-å¸¸è§-applicationcontext-å®ç°" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-å¸¸è§-applicationcontext-å®ç°"><span>æ¼”ç¤º2 - å¸¸è§ ApplicationContext å®ç°</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-2" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-2"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a02.A02</strong></p>
<h4 id="æ”¶è·ğŸ’¡-2" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-2"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å¸¸è§çš„ ApplicationContext å®¹å™¨å®ç°</li>
<li>å†…åµŒå®¹å™¨ã€DispatcherServlet çš„åˆ›å»ºæ–¹æ³•ã€ä½œç”¨</li>
</ol>
<h3 id="_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#_3-bean-çš„ç”Ÿå‘½å‘¨æœŸ"><span>3) Bean çš„ç”Ÿå‘½å‘¨æœŸ</span></a></h3>
<p>ä¸€ä¸ªå— Spring ç®¡ç†çš„ beanï¼Œç”Ÿå‘½å‘¨æœŸä¸»è¦é˜¶æ®µæœ‰</p>
<ol>
<li>åˆ›å»ºï¼šæ ¹æ® bean çš„æ„é€ æ–¹æ³•æˆ–è€…å·¥å‚æ–¹æ³•æ¥åˆ›å»º bean å®ä¾‹å¯¹è±¡</li>
<li>ä¾èµ–æ³¨å…¥ï¼šæ ¹æ® @Autowiredï¼Œ@Value æˆ–å…¶å®ƒä¸€äº›æ‰‹æ®µï¼Œä¸º bean çš„æˆå‘˜å˜é‡å¡«å……å€¼ã€å»ºç«‹å…³ç³»</li>
<li>åˆå§‹åŒ–ï¼šå›è°ƒå„ç§ Aware æ¥å£ï¼Œè°ƒç”¨å¯¹è±¡çš„å„ç§åˆå§‹åŒ–æ–¹æ³•</li>
<li>é”€æ¯ï¼šåœ¨å®¹å™¨å…³é—­æ—¶ï¼Œä¼šé”€æ¯æ‰€æœ‰å•ä¾‹å¯¹è±¡ï¼ˆå³è°ƒç”¨å®ƒä»¬çš„é”€æ¯æ–¹æ³•ï¼‰
<ul>
<li>prototype å¯¹è±¡ä¹Ÿèƒ½å¤Ÿé”€æ¯ï¼Œä¸è¿‡éœ€è¦å®¹å™¨è¿™è¾¹ä¸»åŠ¨è°ƒç”¨</li>
</ul>
</li>
</ol>
<p>ä¸€äº›èµ„æ–™ä¼šæåˆ°ï¼Œç”Ÿå‘½å‘¨æœŸä¸­è¿˜æœ‰ä¸€ç±» bean åå¤„ç†å™¨ï¼šBeanPostProcessorï¼Œä¼šåœ¨ bean çš„åˆå§‹åŒ–çš„å‰åï¼Œæä¾›ä¸€äº›æ‰©å±•é€»è¾‘ã€‚ä½†è¿™ç§è¯´æ³•æ˜¯ä¸å®Œæ•´çš„ï¼Œè§ä¸‹é¢çš„æ¼”ç¤º1</p>
<h4 id="æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ"><span>æ¼”ç¤º1 - bean ç”Ÿå‘½å‘¨æœŸ</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-3" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-3"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a03</strong> åŒ…</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">graph LR</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">åˆ›å»º --> ä¾èµ–æ³¨å…¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ä¾èµ–æ³¨å…¥ --> åˆå§‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">åˆå§‹åŒ– --> å¯ç”¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">å¯ç”¨ --> é”€æ¯</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºå‰åçš„å¢å¼º</p>
<ul>
<li>postProcessBeforeInstantiation
<ul>
<li>è¿™é‡Œè¿”å›çš„å¯¹è±¡è‹¥ä¸ä¸º null ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ beanï¼Œå¹¶ä¸”ä»…ä¼šèµ° postProcessAfterInitialization æµç¨‹</li>
</ul>
</li>
<li>postProcessAfterInstantiation
<ul>
<li>è¿™é‡Œå¦‚æœè¿”å› false ä¼šè·³è¿‡ä¾èµ–æ³¨å…¥é˜¶æ®µ</li>
</ul>
</li>
</ul>
<p>ä¾èµ–æ³¨å…¥å‰çš„å¢å¼º</p>
<ul>
<li>postProcessProperties
<ul>
<li>å¦‚ @Autowiredã€@Valueã€@Resource</li>
</ul>
</li>
</ul>
<p>åˆå§‹åŒ–å‰åçš„å¢å¼º</p>
<ul>
<li>postProcessBeforeInitialization
<ul>
<li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li>
<li>å¦‚ @PostConstructã€@ConfigurationProperties</li>
</ul>
</li>
<li>postProcessAfterInitialization
<ul>
<li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li>
<li>å¦‚ä»£ç†å¢å¼º</li>
</ul>
</li>
</ul>
<p>é”€æ¯ä¹‹å‰çš„å¢å¼º</p>
<ul>
<li>postProcessBeforeDestruction
<ul>
<li>å¦‚ @PreDestroy</li>
</ul>
</li>
</ul>
<h4 id="æ”¶è·ğŸ’¡-3" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-3"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Spring bean ç”Ÿå‘½å‘¨æœŸå„ä¸ªé˜¶æ®µ</li>
<li>æ¨¡æ¿è®¾è®¡æ¨¡å¼, æŒ‡å¤§æµç¨‹å·²ç»å›ºå®šå¥½äº†, é€šè¿‡æ¥å£å›è°ƒï¼ˆbean åå¤„ç†å™¨ï¼‰åœ¨ä¸€äº›å…³é”®ç‚¹å‰åæä¾›æ‰©å±•</li>
</ol>
<h4 id="æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼"><span>æ¼”ç¤º2 - æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</span></a></h4>
<h5 id="å…³é”®ä»£ç " tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç "><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> TestMethodTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        MyBeanFactory</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> beanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> MyBeanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        beanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addBeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(bean </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"è§£æ @Autowired"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        beanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addBeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(bean </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"è§£æ @Resource"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        beanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // æ¨¡æ¿æ–¹æ³•  Template Method Pattern</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyBeanFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Object</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> getBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> bean</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"æ„é€  "</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> bean);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"ä¾èµ–æ³¨å…¥ "</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> bean); </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">// @Autowired, @Resource</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">BeanPostProcessor</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> processor</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> processors) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                processor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">inject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(bean);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"åˆå§‹åŒ– "</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> bean);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> bean;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> List</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">BeanPostProcessor</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">></span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> processors </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ArrayList</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;></span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> addBeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">BeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> processor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            processors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(processor);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> interface</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> BeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> inject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Object</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> bean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // å¯¹ä¾èµ–æ³¨å…¥é˜¶æ®µçš„æ‰©å±•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº"><span>æ¼”ç¤º3 - bean åå¤„ç†å™¨æ’åº</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-4" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-4"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a03.TestProcessOrder</strong></p>
<h4 id="æ”¶è·ğŸ’¡-4" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-4"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å®ç°äº† PriorityOrdered æ¥å£çš„ä¼˜å…ˆçº§æœ€é«˜</li>
<li>å®ç°äº† Ordered æ¥å£ä¸åŠ äº† @Order æ³¨è§£çš„å¹³çº§, æŒ‰æ•°å­—å‡åº</li>
<li>å…¶å®ƒçš„æ’åœ¨æœ€å</li>
</ol>
<h3 id="_4-bean-åå¤„ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_4-bean-åå¤„ç†å™¨"><span>4) Bean åå¤„ç†å™¨</span></a></h3>
<h4 id="æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨"><span>æ¼”ç¤º1 - åå¤„ç†å™¨ä½œç”¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-5" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-5"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a04</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-5" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-5"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>@Autowired ç­‰æ³¨è§£çš„è§£æå±äº bean ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼ˆä¾èµ–æ³¨å…¥, åˆå§‹åŒ–ï¼‰çš„æ‰©å±•åŠŸèƒ½ï¼Œè¿™äº›æ‰©å±•åŠŸèƒ½ç”± bean åå¤„ç†å™¨æ¥å®Œæˆ</li>
<li>æ¯ä¸ªåå¤„ç†å™¨å„è‡ªå¢å¼ºä»€ä¹ˆåŠŸèƒ½
<ul>
<li>AutowiredAnnotationBeanPostProcessor è§£æ @Autowired ä¸ @Value</li>
<li>CommonAnnotationBeanPostProcessor è§£æ @Resourceã€@PostConstructã€@PreDestroy</li>
<li>ConfigurationPropertiesBindingPostProcessor è§£æ @ConfigurationProperties</li>
</ul>
</li>
<li>å¦å¤– ContextAnnotationAutowireCandidateResolver è´Ÿè´£è·å– @Value çš„å€¼ï¼Œè§£æ @Qualifierã€æ³›å‹ã€@Lazy ç­‰</li>
</ol>
<h4 id="æ¼”ç¤º2-autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ"><span>æ¼”ç¤º2 - @Autowired bean åå¤„ç†å™¨è¿è¡Œåˆ†æ</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-6" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-6"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a04.DigInAutowired</strong></p>
<h4 id="æ”¶è·ğŸ’¡-6" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-6"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>AutowiredAnnotationBeanPostProcessor.findAutowiringMetadata ç”¨æ¥è·å–æŸä¸ª bean ä¸ŠåŠ äº† @Value @Autowired çš„æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°çš„ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸º InjectionMetadata</li>
<li>InjectionMetadata å¯ä»¥å®Œæˆä¾èµ–æ³¨å…¥</li>
<li>InjectionMetadata å†…éƒ¨æ ¹æ®æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°å°è£…ä¸º DependencyDescriptor ç±»å‹</li>
<li>æœ‰äº† DependencyDescriptorï¼Œå°±å¯ä»¥åˆ©ç”¨ beanFactory.doResolveDependency æ–¹æ³•è¿›è¡ŒåŸºäºç±»å‹çš„æŸ¥æ‰¾</li>
</ol>
<h3 id="_5-beanfactory-åå¤„ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_5-beanfactory-åå¤„ç†å™¨"><span>5) BeanFactory åå¤„ç†å™¨</span></a></h3>
<h4 id="æ¼”ç¤º1-beanfactory-åå¤„ç†å™¨çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-beanfactory-åå¤„ç†å™¨çš„ä½œç”¨"><span>æ¼”ç¤º1 - BeanFactory åå¤„ç†å™¨çš„ä½œç”¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-7" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-7"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a05</strong> åŒ…</p>
<ul>
<li>ConfigurationClassPostProcessor å¯ä»¥è§£æ
<ul>
<li>@ComponentScan</li>
<li>@Bean</li>
<li>@Import</li>
<li>@ImportResource</li>
</ul>
</li>
<li>MapperScannerConfigurer å¯ä»¥è§£æ
<ul>
<li>Mapper æ¥å£</li>
</ul>
</li>
</ul>
<h4 id="æ”¶è·ğŸ’¡-7" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-7"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>@ComponentScan, @Bean, @Mapper ç­‰æ³¨è§£çš„è§£æå±äºæ ¸å¿ƒå®¹å™¨ï¼ˆå³ BeanFactoryï¼‰çš„æ‰©å±•åŠŸèƒ½</li>
<li>è¿™äº›æ‰©å±•åŠŸèƒ½ç”±ä¸åŒçš„ BeanFactory åå¤„ç†å™¨æ¥å®Œæˆï¼Œå…¶å®ä¸»è¦å°±æ˜¯è¡¥å……äº†ä¸€äº› bean å®šä¹‰</li>
</ol>
<h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-componentscan" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-componentscan"><span>æ¼”ç¤º2 - æ¨¡æ‹Ÿè§£æ @ComponentScan</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-8" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-8"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a05.ComponentScanPostProcessor</strong></p>
<h4 id="æ”¶è·ğŸ’¡-8" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-8"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Spring æ“ä½œå…ƒæ•°æ®çš„å·¥å…·ç±» CachingMetadataReaderFactory</li>
<li>é€šè¿‡æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–ç›´æ¥æˆ–é—´æ¥æ ‡æ³¨çš„æ³¨è§£ä¿¡æ¯</li>
<li>é€šè¿‡ç±»å…ƒæ•°æ®ï¼ˆClassMetadataï¼‰è·å–ç±»åï¼ŒAnnotationBeanNameGenerator ç”Ÿæˆ bean å</li>
<li>è§£æå…ƒæ•°æ®æ˜¯åŸºäº ASM æŠ€æœ¯</li>
</ol>
<h4 id="æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-bean" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-bean"><span>æ¼”ç¤º3 - æ¨¡æ‹Ÿè§£æ @Bean</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-9" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-9"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a05.AtBeanPostProcessor</strong></p>
<h4 id="æ”¶è·ğŸ’¡-9" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-9"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>è¿›ä¸€æ­¥ç†Ÿæ‚‰æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–æ–¹æ³•ä¸Šæ³¨è§£ä¿¡æ¯</li>
</ol>
<h4 id="æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-mapper-æ¥å£" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-mapper-æ¥å£"><span>æ¼”ç¤º4 - æ¨¡æ‹Ÿè§£æ Mapper æ¥å£</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-10" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-10"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a05.MapperPostProcessor</strong></p>
<h4 id="æ”¶è·ğŸ’¡-10" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-10"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Mapper æ¥å£è¢« Spring ç®¡ç†çš„æœ¬è´¨ï¼šå®é™…æ˜¯è¢«ä½œä¸º MapperFactoryBean æ³¨å†Œåˆ°å®¹å™¨ä¸­</li>
<li>Spring çš„è¯¡å¼‚åšæ³•ï¼Œæ ¹æ®æ¥å£ç”Ÿæˆçš„ BeanDefinition ä»…ä¸ºæ ¹æ®æ¥å£åç”Ÿæˆ bean å</li>
</ol>
<h3 id="_6-aware-æ¥å£" tabindex="-1"><a class="header-anchor" href="#_6-aware-æ¥å£"><span>6) Aware æ¥å£</span></a></h3>
<h4 id="æ¼”ç¤º-aware-æ¥å£åŠ-initializingbean-æ¥å£" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-aware-æ¥å£åŠ-initializingbean-æ¥å£"><span>æ¼”ç¤º - Aware æ¥å£åŠ InitializingBean æ¥å£</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-11" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-11"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a06</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-11" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-11"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Aware æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘ çš„æ³¨å…¥æ‰‹æ®µï¼Œä¾‹å¦‚
<ul>
<li>BeanNameAware æ³¨å…¥ bean çš„åå­—</li>
<li>BeanFactoryAware æ³¨å…¥ BeanFactory å®¹å™¨</li>
<li>ApplicationContextAware æ³¨å…¥ ApplicationContext å®¹å™¨</li>
<li>EmbeddedValueResolverAware æ³¨å…¥ ${} è§£æå™¨</li>
</ul>
</li>
<li>InitializingBean æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘çš„åˆå§‹åŒ–æ‰‹æ®µ</li>
<li>å¯¹æ¯”
<ul>
<li>å†…ç½®çš„æ³¨å…¥å’Œåˆå§‹åŒ–ä¸å—æ‰©å±•åŠŸèƒ½çš„å½±å“ï¼Œæ€»ä¼šè¢«æ‰§è¡Œ</li>
<li>è€Œæ‰©å±•åŠŸèƒ½å—æŸäº›æƒ…å†µå½±å“å¯èƒ½ä¼šå¤±æ•ˆ</li>
<li>å› æ­¤ Spring æ¡†æ¶å†…éƒ¨çš„ç±»å¸¸ç”¨å†…ç½®æ³¨å…¥å’Œåˆå§‹åŒ–</li>
</ul>
</li>
</ol>
<h4 id="é…ç½®ç±»-autowired-å¤±æ•ˆåˆ†æ" tabindex="-1"><a class="header-anchor" href="#é…ç½®ç±»-autowired-å¤±æ•ˆåˆ†æ"><span>é…ç½®ç±» @Autowired å¤±æ•ˆåˆ†æ</span></a></h4>
<p>Java é…ç½®ç±»ä¸åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µ</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ac as ApplicationContext</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bfpp as BeanFactoryPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bpp as BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant config as Javaé…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> bfpp : 1. æ‰§è¡Œ BeanFactoryPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> bpp : 2. æ³¨å†Œ BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> +config : 3. åˆ›å»ºå’Œåˆå§‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bpp ->> config : 3.1 ä¾èµ–æ³¨å…¥æ‰©å±•(å¦‚ @Value å’Œ @Autowired)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bpp ->> config : 3.2 åˆå§‹åŒ–æ‰©å±•(å¦‚ @PostConstruct)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> config : 3.3 æ‰§è¡Œ Aware åŠ InitializingBean</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">config -->> -ac : 3.4 åˆ›å»ºæˆåŠŸ</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java é…ç½®ç±»åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µï¼Œå› æ­¤è¦åˆ›å»ºå…¶ä¸­çš„ BeanFactoryPostProcessor å¿…é¡»æå‰åˆ›å»º Java é…ç½®ç±»ï¼Œè€Œæ­¤æ—¶çš„ BeanPostProcessor è¿˜æœªå‡†å¤‡å¥½ï¼Œå¯¼è‡´ @Autowired ç­‰æ³¨è§£å¤±æ•ˆ</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ac as ApplicationContext</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bfpp as BeanFactoryPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bpp as BeanPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant config as Javaé…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> +config : 3. åˆ›å»ºå’Œåˆå§‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> config : 3.1 æ‰§è¡Œ Aware åŠ InitializingBean</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">config -->> -ac : 3.2 åˆ›å»ºæˆåŠŸ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> bfpp : 1. æ‰§è¡Œ BeanFactoryPostProcessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ac ->> bpp : 2. æ³¨å†Œ BeanPostProcessor</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”ä»£ç </p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Configuration</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyConfig1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> LoggerFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getLogger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MyConfig1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Autowired</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> setApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> applicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"æ³¨å…¥ ApplicationContext"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">PostConstruct</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"åˆå§‹åŒ–"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> //  â¬…ï¸ æ³¨é‡Šæˆ–æ·»åŠ  beanFactory åå¤„ç†å™¨å¯¹åº”ä¸Šæ–¹ä¸¤ç§æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> BeanFactoryPostProcessor</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> processor1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> beanFactory </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"æ‰§è¡Œ processor1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        };</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>ç”¨å†…ç½®ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å–ä»£æ‰©å±•ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–</li>
<li>ç”¨é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿å®ä¾‹å·¥å‚æ–¹æ³•ï¼Œé¿å…å·¥å‚å¯¹è±¡æå‰è¢«åˆ›å»º</li>
</ul>
</blockquote>
<h3 id="_7-åˆå§‹åŒ–ä¸é”€æ¯" tabindex="-1"><a class="header-anchor" href="#_7-åˆå§‹åŒ–ä¸é”€æ¯"><span>7) åˆå§‹åŒ–ä¸é”€æ¯</span></a></h3>
<h4 id="æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº"><span>æ¼”ç¤º - åˆå§‹åŒ–é”€æ¯é¡ºåº</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-12" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-12"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a07</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-12" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-12"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>Spring æä¾›äº†å¤šç§åˆå§‹åŒ–æ‰‹æ®µï¼Œé™¤äº†è¯¾å ‚ä¸Šè®²çš„ @PostConstructï¼Œ@Bean(initMethod) ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®ç° InitializingBean æ¥å£æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœåŒä¸€ä¸ª bean ç”¨äº†ä»¥ä¸Šæ‰‹æ®µå£°æ˜äº† 3 ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯</p>
<ol>
<li>@PostConstruct æ ‡æ³¨çš„åˆå§‹åŒ–æ–¹æ³•</li>
<li>InitializingBean æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•</li>
<li>@Bean(initMethod) æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•</li>
</ol>
<p>ä¸åˆå§‹åŒ–ç±»ä¼¼ï¼ŒSpring ä¹Ÿæä¾›äº†å¤šç§é”€æ¯æ‰‹æ®µï¼Œæ‰§è¡Œé¡ºåºä¸º</p>
<ol>
<li>@PreDestroy æ ‡æ³¨çš„é”€æ¯æ–¹æ³•</li>
<li>DisposableBean æ¥å£çš„é”€æ¯æ–¹æ³•</li>
<li>@Bean(destroyMethod) æŒ‡å®šçš„é”€æ¯æ–¹æ³•</li>
</ol>
<h3 id="_8-scope" tabindex="-1"><a class="header-anchor" href="#_8-scope"><span>8) Scope</span></a></h3>
<p>åœ¨å½“å‰ç‰ˆæœ¬çš„ Spring å’Œ Spring Boot ç¨‹åºä¸­ï¼Œæ”¯æŒäº”ç§ Scope</p>
<ul>
<li>singletonï¼Œå®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºï¼ˆæœªè®¾ç½®å»¶è¿Ÿï¼‰ï¼Œå®¹å™¨å…³é—­æ—¶é”€æ¯</li>
<li>prototypeï¼Œæ¯æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œä¸ä¼šè‡ªåŠ¨é”€æ¯ï¼Œéœ€è¦è°ƒç”¨ DefaultListableBeanFactory.destroyBean(bean) é”€æ¯</li>
<li>requestï¼Œæ¯æ¬¡è¯·æ±‚ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œè¯·æ±‚ç»“æŸæ—¶é”€æ¯</li>
<li>sessionï¼Œæ¯ä¸ªä¼šè¯ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œä¼šè¯ç»“æŸæ—¶é”€æ¯</li>
<li>applicationï¼Œweb å®¹å™¨ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œå®¹å™¨åœæ­¢æ—¶é”€æ¯</li>
</ul>
<p>æœ‰äº›æ–‡ç« æåˆ°æœ‰ globalSession è¿™ä¸€ Scopeï¼Œä¹Ÿæ˜¯é™ˆæ—§çš„è¯´æ³•ï¼Œç›®å‰ Spring ä¸­å·²åºŸå¼ƒ</p>
<p>ä½†è¦æ³¨æ„ï¼Œå¦‚æœåœ¨ singleton æ³¨å…¥å…¶å®ƒ scope éƒ½ä¼šæœ‰é—®é¢˜ï¼Œè§£å†³æ–¹æ³•æœ‰</p>
<ul>
<li>@Lazy</li>
<li>@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)</li>
<li>ObjectFactory</li>
<li>ApplicationContext.getBean</li>
</ul>
<h4 id="æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ"><span>æ¼”ç¤º1 - request, session, application ä½œç”¨åŸŸ</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-13" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-13"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a08</strong> åŒ…</p>
<ul>
<li>æ‰“å¼€ä¸åŒçš„æµè§ˆå™¨, åˆ·æ–° http://localhost:8080/test å³å¯æŸ¥çœ‹æ•ˆæœ</li>
<li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMED</li>
</ul>
<h4 id="æ”¶è·ğŸ’¡-13" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-13"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>æœ‰å‡ ç§ scope</li>
<li>åœ¨ singleton ä¸­ä½¿ç”¨å…¶å®ƒå‡ ç§ scope çš„æ–¹æ³•</li>
<li>å…¶å®ƒ scope çš„é”€æ¯æ—¶æœº
<ul>
<li>å¯ä»¥å°†é€šè¿‡ server.servlet.session.timeout=30s è§‚å¯Ÿ session bean çš„é”€æ¯</li>
<li>ServletContextScope é”€æ¯æœºåˆ¶ç–‘ä¼¼å®ç°æœ‰è¯¯</li>
</ul>
</li>
</ol>
<h4 id="åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ" tabindex="-1"><a class="header-anchor" href="#åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ"><span>åˆ†æ - singleton æ³¨å…¥å…¶å®ƒ scope å¤±æ•ˆ</span></a></h4>
<p>ä»¥å•ä¾‹æ³¨å…¥å¤šä¾‹ä¸ºä¾‹</p>
<p>æœ‰ä¸€ä¸ªå•ä¾‹å¯¹è±¡ E</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Component</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> E</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> LoggerFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getLogger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">E</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> F</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> E</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"E()"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Autowired</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> setF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">F</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> f;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"setF(F f) {}"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> F</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> getF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> f;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æ³¨å…¥çš„å¯¹è±¡ F æœŸæœ›æ˜¯å¤šä¾‹</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Component</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Scope</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"prototype"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> F</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    private</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> final</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Logger</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> LoggerFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getLogger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">F</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> F</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"F()"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">E</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> e </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">E</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">F</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> f1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">F</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> f2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(f1);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(f2);</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡º</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>com.itheima.demo.cycle.F@6622fc65</span></span>
<span class="line"><span>com.itheima.demo.cycle.F@6622fc65</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘ç°å®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æœŸæœ›çš„å¤šä¾‹å¯¹è±¡</p>
<p>å¯¹äºå•ä¾‹å¯¹è±¡æ¥è®²ï¼Œä¾èµ–æ³¨å…¥ä»…å‘ç”Ÿäº†ä¸€æ¬¡ï¼Œåç»­å†æ²¡æœ‰ç”¨åˆ°å¤šä¾‹çš„ Fï¼Œå› æ­¤ E ç”¨çš„å§‹ç»ˆæ˜¯ç¬¬ä¸€æ¬¡ä¾èµ–æ³¨å…¥çš„ F</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">graph LR</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e1(e åˆ›å»º)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e2(e set æ³¨å…¥ f)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">f1(f åˆ›å»º)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e1-->f1-->e2</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§£å†³</p>
<ul>
<li>ä»ç„¶ä½¿ç”¨ @Lazy ç”Ÿæˆä»£ç†</li>
<li>ä»£ç†å¯¹è±¡è™½ç„¶è¿˜æ˜¯åŒä¸€ä¸ªï¼Œä½†å½“æ¯æ¬¡<strong>ä½¿ç”¨ä»£ç†å¯¹è±¡çš„ä»»æ„æ–¹æ³•</strong>æ—¶ï¼Œç”±ä»£ç†åˆ›å»ºæ–°çš„ f å¯¹è±¡</li>
</ul>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">graph LR</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e1(e åˆ›å»º)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e2(e set æ³¨å…¥ fä»£ç†)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">f1(f åˆ›å»º)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">f2(f åˆ›å»º)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">f3(f åˆ›å»º)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e1-->e2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e2--ä½¿ç”¨fæ–¹æ³•-->f1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e2--ä½¿ç”¨fæ–¹æ³•-->f2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e2--ä½¿ç”¨fæ–¹æ³•-->f3</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Component</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> E</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Autowired</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Lazy</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> setF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">F</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> f;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"setF(F f) {}"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>@Lazy åŠ åœ¨ä¹Ÿå¯ä»¥åŠ åœ¨æˆå‘˜å˜é‡ä¸Šï¼Œä½†åŠ åœ¨ set æ–¹æ³•ä¸Šçš„ç›®çš„æ˜¯å¯ä»¥è§‚å¯Ÿè¾“å‡ºï¼ŒåŠ åœ¨æˆå‘˜å˜é‡ä¸Šå°±ä¸è¡Œäº†</li>
<li>@Autowired åŠ åœ¨ set æ–¹æ³•çš„ç›®çš„ç±»ä¼¼</li>
</ul>
</blockquote>
<p>è¾“å‡º</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>E: setF(F f) class com.itheima.demo.cycle.F$$EnhancerBySpringCGLIB$$8b54f2bc</span></span>
<span class="line"><span>F: F()</span></span>
<span class="line"><span>com.itheima.demo.cycle.F@3a6f2de3</span></span>
<span class="line"><span>F: F()</span></span>
<span class="line"><span>com.itheima.demo.cycle.F@56303b57</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºæ—¥å¿—å¯ä»¥çœ‹åˆ°è°ƒç”¨ setF æ–¹æ³•æ—¶ï¼Œf å¯¹è±¡çš„ç±»å‹æ˜¯ä»£ç†ç±»å‹</p>
<h4 id="æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•"><span>æ¼”ç¤º2 - 4ç§è§£å†³æ–¹æ³•</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-14" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-14"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a08.sub</strong> åŒ…</p>
<ul>
<li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang=ALL-UNNAMED</li>
</ul>
<h4 id="æ”¶è·ğŸ’¡-14" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-14"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å•ä¾‹æ³¨å…¥å…¶å®ƒ scope çš„å››ç§è§£å†³æ–¹æ³•
<ul>
<li>@Lazy</li>
<li>@Scope(value = &quot;prototype&quot;, proxyMode = ScopedProxyMode.TARGET_CLASS)</li>
<li>ObjectFactory</li>
<li>ApplicationContext</li>
</ul>
</li>
<li>è§£å†³æ–¹æ³•è™½ç„¶ä¸åŒï¼Œä½†ç†å¿µä¸Šæ®Šé€”åŒå½’: éƒ½æ˜¯æ¨è¿Ÿå…¶å®ƒ scope bean çš„è·å–</li>
</ol>
<h2 id="aop" tabindex="-1"><a class="header-anchor" href="#aop"><span>AOP</span></a></h2>
<p>AOP åº•å±‚å®ç°æ–¹å¼ä¹‹ä¸€æ˜¯ä»£ç†ï¼Œç”±ä»£ç†ç»“åˆé€šçŸ¥å’Œç›®æ ‡ï¼Œæä¾›å¢å¼ºåŠŸèƒ½</p>
<p>é™¤æ­¤ä»¥å¤–ï¼Œaspectj æä¾›äº†ä¸¤ç§å¦å¤–çš„ AOP åº•å±‚å®ç°ï¼š</p>
<ul>
<li>
<p>ç¬¬ä¸€ç§æ˜¯é€šè¿‡ ajc ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘</strong> class ç±»æ–‡ä»¶æ—¶ï¼Œå°±æŠŠé€šçŸ¥çš„å¢å¼ºåŠŸèƒ½ï¼Œç»‡å…¥åˆ°ç›®æ ‡ç±»çš„å­—èŠ‚ç ä¸­</p>
</li>
<li>
<p>ç¬¬äºŒç§æ˜¯é€šè¿‡ agent åœ¨<strong>åŠ è½½</strong>ç›®æ ‡ç±»æ—¶ï¼Œä¿®æ”¹ç›®æ ‡ç±»çš„å­—èŠ‚ç ï¼Œç»‡å…¥å¢å¼ºåŠŸèƒ½</p>
</li>
<li>
<p>ä½œä¸ºå¯¹æ¯”ï¼Œä¹‹å‰å­¦ä¹ çš„ä»£ç†æ˜¯<strong>è¿è¡Œ</strong>æ—¶ç”Ÿæˆæ–°çš„å­—èŠ‚ç </p>
</li>
</ul>
<p>ç®€å•æ¯”è¾ƒçš„è¯ï¼š</p>
<ul>
<li>aspectj åœ¨ç¼–è¯‘å’ŒåŠ è½½æ—¶ï¼Œä¿®æ”¹ç›®æ ‡å­—èŠ‚ç ï¼Œæ€§èƒ½è¾ƒé«˜</li>
<li>aspectj å› ä¸ºä¸ç”¨ä»£ç†ï¼Œèƒ½çªç ´ä¸€äº›æŠ€æœ¯ä¸Šçš„é™åˆ¶ï¼Œä¾‹å¦‚å¯¹æ„é€ ã€å¯¹é™æ€æ–¹æ³•ã€å¯¹ final ä¹Ÿèƒ½å¢å¼º</li>
<li>ä½† aspectj ä¾µå…¥æ€§è¾ƒå¼ºï¼Œä¸”éœ€è¦å­¦ä¹ æ–°çš„ aspectj ç‰¹æœ‰è¯­æ³•ï¼Œå› æ­¤æ²¡æœ‰å¹¿æ³›æµè¡Œ</li>
</ul>
<h3 id="_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨" tabindex="-1"><a class="header-anchor" href="#_9-aop-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨"><span>9) AOP å®ç°ä¹‹ ajc ç¼–è¯‘å™¨</span></a></h3>
<p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_01</strong></p>
<h4 id="æ”¶è·ğŸ’¡-15" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-15"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ç¼–è¯‘å™¨ä¹Ÿèƒ½ä¿®æ”¹ class å®ç°å¢å¼º</li>
<li>ç¼–è¯‘å™¨å¢å¼ºèƒ½çªç ´ä»£ç†ä»…èƒ½é€šè¿‡æ–¹æ³•é‡å†™å¢å¼ºçš„é™åˆ¶ï¼šå¯ä»¥å¯¹æ„é€ æ–¹æ³•ã€é™æ€æ–¹æ³•ç­‰å®ç°å¢å¼º</li>
</ol>
<blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>ç‰ˆæœ¬é€‰æ‹©äº† java 8, å› ä¸ºç›®å‰çš„ aspectj-maven-plugin 1.14.0 æœ€é«˜åªæ”¯æŒåˆ° java 16</li>
<li>ä¸€å®šè¦ç”¨ maven çš„ compile æ¥ç¼–è¯‘, idea ä¸ä¼šè°ƒç”¨ ajc ç¼–è¯‘å™¨</li>
</ul>
</blockquote>
<h3 id="_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½" tabindex="-1"><a class="header-anchor" href="#_10-aop-å®ç°ä¹‹-agent-ç±»åŠ è½½"><span>10) AOP å®ç°ä¹‹ agent ç±»åŠ è½½</span></a></h3>
<p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_02</strong></p>
<h4 id="æ”¶è·ğŸ’¡-16" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-16"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ç±»åŠ è½½æ—¶å¯ä»¥é€šè¿‡ agent ä¿®æ”¹ class å®ç°å¢å¼º</li>
</ol>
<h3 id="_11-aop-å®ç°ä¹‹-proxy" tabindex="-1"><a class="header-anchor" href="#_11-aop-å®ç°ä¹‹-proxy"><span>11) AOP å®ç°ä¹‹ proxy</span></a></h3>
<h4 id="æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†"><span>æ¼”ç¤º1 - jdk åŠ¨æ€ä»£ç†</span></a></h4>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> JdkProxyDemo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    interface</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Target</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"target foo"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">param</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // ç›®æ ‡å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Target</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> target</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // ä»£ç†å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Foo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (Foo) </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">newProxyInstance</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getClassLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(), </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]{</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">},</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                (p, method, args) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy before..."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                    Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> result</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> method</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(target, args);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy after..."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                });</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // è°ƒç”¨ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œç»“æœ</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>proxy before...</span></span>
<span class="line"><span>target foo</span></span>
<span class="line"><span>proxy after...</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-17" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-17"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ul>
<li>jdk åŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡<strong>å¿…é¡»</strong>å®ç°æ¥å£ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å®ç°ç›¸åŒæ¥å£ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å¹³çº§å…„å¼Ÿå…³ç³»</li>
</ul>
<h4 id="æ¼”ç¤º2-cglib-ä»£ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-cglib-ä»£ç†"><span>æ¼”ç¤º2 - cglib ä»£ç†</span></a></h4>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> CglibProxyDemo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"target foo"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">param</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // ç›®æ ‡å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Target</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> target</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // ä»£ç†å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Target</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (Target) </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Enhancer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                (MethodInterceptor) (p, method, args, methodProxy) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy before..."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> result</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> methodProxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(target, args);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">            // å¦ä¸€ç§è°ƒç”¨æ–¹æ³•ï¼Œä¸éœ€è¦ç›®æ ‡å¯¹è±¡å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">//            Object result = methodProxy.invokeSuper(p, args);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy after..."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        });</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // è°ƒç”¨ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œç»“æœä¸ jdk åŠ¨æ€ä»£ç†ç›¸åŒ</p>
<h4 id="æ”¶è·ğŸ’¡-18" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-18"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ul>
<li>cglib ä¸è¦æ±‚ç›®æ ‡å®ç°æ¥å£ï¼Œå®ƒç”Ÿæˆçš„ä»£ç†ç±»æ˜¯ç›®æ ‡çš„å­ç±»ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å­çˆ¶å…³ç³»</li>
<li>é™åˆ¶â›”ï¼šæ ¹æ®ä¸Šè¿°åˆ†æ final ç±»æ— æ³•è¢« cglib å¢å¼º</li>
</ul>
<h3 id="_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#_12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶"><span>12) jdk åŠ¨æ€ä»£ç†è¿›é˜¶</span></a></h3>
<h4 id="æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†"><span>æ¼”ç¤º1 - æ¨¡æ‹Ÿ jdk åŠ¨æ€ä»£ç†</span></a></h4>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> A12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    interface</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Target</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"target foo"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"target bar"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">param</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // â¬‡ï¸1. åˆ›å»ºä»£ç†ï¼Œè¿™æ—¶ä¼ å…¥ InvocationHandler</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Foo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> $Proxy0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> InvocationHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">() {    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">            // â¬‡ï¸5. è¿›å…¥ InvocationHandler</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Object</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Object</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Method</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> method</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Throwable</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">                // â¬‡ï¸6. åŠŸèƒ½å¢å¼º</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"before..."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">                // â¬‡ï¸7. åå°„è°ƒç”¨ç›®æ ‡æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> method</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(), args);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        });</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // â¬‡ï¸2. è°ƒç”¨ä»£ç†æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¨¡æ‹Ÿä»£ç†å®ç°</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.lang.reflect.InvocationHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.lang.reflect.Method</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.lang.reflect.Proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.lang.reflect.UndeclaredThrowableException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">// â¬‡ï¸è¿™å°±æ˜¯ jdk ä»£ç†ç±»çš„æºç , ç§˜å¯†éƒ½åœ¨é‡Œé¢</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> $Proxy0</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> extends</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Proxy</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> A12</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> $</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Proxy0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">InvocationHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(h);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // â¬‡ï¸3. è¿›å…¥ä»£ç†æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">            // â¬‡ï¸4. å›è°ƒ InvocationHandler</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, foo, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> e;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Throwable</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> UndeclaredThrowableException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(e);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Override</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> result</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, bar, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> e;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Throwable</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> UndeclaredThrowableException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(e);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Method</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Method</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    static</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">            foo </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> A12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMethod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"foo"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">            bar </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> A12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMethod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"bar"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">NoSuchMethodException</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> NoSuchMethodError</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-19" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-19"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>ä»£ç†ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œæ— éå°±æ˜¯åˆ©ç”¨äº†å¤šæ€ã€åå°„çš„çŸ¥è¯†</p>
<ol>
<li>æ–¹æ³•é‡å†™å¯ä»¥å¢å¼ºé€»è¾‘ï¼Œåªä¸è¿‡è¿™ã€å¢å¼ºé€»è¾‘ã€‘åƒå˜ä¸‡åŒ–ï¼Œä¸èƒ½å†™æ­»åœ¨ä»£ç†å†…éƒ¨</li>
<li>é€šè¿‡æ¥å£å›è°ƒå°†ã€å¢å¼ºé€»è¾‘ã€‘ç½®äºä»£ç†ç±»ä¹‹å¤–</li>
<li>é…åˆæ¥å£æ–¹æ³•åå°„ï¼ˆæ˜¯å¤šæ€è°ƒç”¨ï¼‰ï¼Œå°±å¯ä»¥å†è”åŠ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•</li>
<li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ä»£ç†ç±»</li>
<li>é™åˆ¶â›”ï¼šä»£ç†å¢å¼ºæ˜¯å€ŸåŠ©å¤šæ€æ¥å®ç°ï¼Œå› æ­¤æˆå‘˜å˜é‡ã€é™æ€æ–¹æ³•ã€final æ–¹æ³•å‡ä¸èƒ½é€šè¿‡ä»£ç†å®ç°</li>
</ol>
<h4 id="æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–"><span>æ¼”ç¤º2 - æ–¹æ³•åå°„ä¼˜åŒ–</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-15" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-15"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a12.TestMethodInvoke</strong></p>
<h4 id="æ”¶è·ğŸ’¡-20" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-20"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å‰ 16 æ¬¡åå°„æ€§èƒ½è¾ƒä½</li>
<li>ç¬¬ 17 æ¬¡è°ƒç”¨ä¼šç”Ÿæˆä»£ç†ç±»ï¼Œä¼˜åŒ–ä¸ºéåå°„è°ƒç”¨</li>
<li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ç¬¬ 17 æ¬¡è°ƒç”¨ç”Ÿæˆçš„ä»£ç†ç±»</li>
</ol>
<blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<p>è¿è¡Œæ—¶è¯·æ·»åŠ  --add-opens java.base/java.lang.reflect=ALL-UNNAMED --add-opens java.base/jdk.internal.reflect=ALL-UNNAMED</p>
</blockquote>
<h3 id="_13-cglib-ä»£ç†è¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#_13-cglib-ä»£ç†è¿›é˜¶"><span>13) cglib ä»£ç†è¿›é˜¶</span></a></h3>
<h4 id="æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†"><span>æ¼”ç¤º - æ¨¡æ‹Ÿ cglib ä»£ç†</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-16" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-16"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a13</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-21" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-21"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>å’Œ jdk åŠ¨æ€ä»£ç†åŸç†æŸ¥ä¸å¤š</p>
<ol>
<li>å›è°ƒçš„æ¥å£æ¢äº†ä¸€ä¸‹ï¼ŒInvocationHandler æ”¹æˆäº† MethodInterceptor</li>
<li>è°ƒç”¨ç›®æ ‡æ—¶æœ‰æ‰€æ”¹è¿›ï¼Œè§ä¸‹é¢ä»£ç ç‰‡æ®µ
<ol>
<li>method.invoke æ˜¯åå°„è°ƒç”¨ï¼Œå¿…é¡»è°ƒç”¨åˆ°è¶³å¤Ÿæ¬¡æ•°æ‰ä¼šè¿›è¡Œä¼˜åŒ–</li>
<li>methodProxy.invoke æ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ï¼ˆSpring é‡‡ç”¨ï¼‰</li>
<li>methodProxy.invokeSuper ä¹Ÿæ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå¯ä»¥çœç•¥ç›®æ ‡å¯¹è±¡</li>
</ol>
</li>
</ol>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> A14Application</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> InvocationTargetException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Target</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> target</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        Proxy</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setCallbacks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Callback</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[]{(MethodInterceptor) (p, m, a, mp) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy before..."</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> mp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getSignature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">            // â¬‡ï¸è°ƒç”¨ç›®æ ‡æ–¹æ³•(ä¸‰ç§)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">//            Object result = m.invoke(target, a);  // â¬…ï¸åå°„è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">//            Object result = mp.invoke(target, a); // â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆç›®æ ‡ç”¨</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            Object</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> result</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> mp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">invokeSuper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(p, a);   </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">// â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆä»£ç†ç”¨</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"proxy after..."</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> mp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getSignature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }});</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // â¬‡ï¸è°ƒç”¨ä»£ç†æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        proxy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>è°ƒç”¨ Object çš„æ–¹æ³•, åä¸¤ç§åœ¨ jdk &gt;= 9 æ—¶éƒ½æœ‰é—®é¢˜, éœ€è¦ --add-opens java.base/java.lang=ALL-UNNAMED</li>
</ul>
</blockquote>
<h3 id="_14-cglib-é¿å…åå°„è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_14-cglib-é¿å…åå°„è°ƒç”¨"><span>14) cglib é¿å…åå°„è°ƒç”¨</span></a></h3>
<h4 id="æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„"><span>æ¼”ç¤º - cglib å¦‚ä½•é¿å…åå°„</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-17" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-17"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a13.ProxyFastClass</strong>ï¼Œ<strong>com.itheima.a13.TargetFastClass</strong></p>
<h4 id="æ”¶è·ğŸ’¡-22" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-22"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å½“è°ƒç”¨ MethodProxy çš„ invoke æˆ– invokeSuper æ–¹æ³•æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆä¸¤ä¸ªç±»
<ul>
<li>ProxyFastClass é…åˆä»£ç†å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„</li>
<li>TargetFastClass é…åˆç›®æ ‡å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„ (Spring ç”¨çš„è¿™ç§)</li>
</ul>
</li>
<li>TargetFastClass è®°å½•äº† Target ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»
<ul>
<li>save(long) ç¼–å· 2</li>
<li>save(int) ç¼–å· 1</li>
<li>save() ç¼–å· 0</li>
<li>é¦–å…ˆæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ä¸ªæ•°ã€ç±»å‹, ç”¨ switch å’Œ if æ‰¾åˆ°è¿™äº›æ–¹æ³•ç¼–å·</li>
<li>ç„¶åå†æ ¹æ®ç¼–å·å»è°ƒç”¨ç›®æ ‡æ–¹æ³•, åˆç”¨äº†ä¸€å¤§å † switch å’Œ if, ä½†é¿å…äº†åå°„</li>
</ul>
</li>
<li>ProxyFastClass è®°å½•äº† Proxy ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»ï¼Œä¸è¿‡ Proxy é¢å¤–æä¾›äº†ä¸‹é¢å‡ ä¸ªæ–¹æ³•
<ul>
<li>saveSuper(long) ç¼–å· 2ï¼Œä¸å¢å¼ºï¼Œä»…æ˜¯è°ƒç”¨ super.save(long)</li>
<li>saveSuper(int) ç¼–å· 1ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save(int)</li>
<li>saveSuper() ç¼–å· 0ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save()</li>
<li>æŸ¥æ‰¾æ–¹å¼ä¸ TargetFastClass ç±»ä¼¼</li>
</ul>
</li>
<li>ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆéº»çƒ¦çš„ä¸€å¥—ä¸œè¥¿å‘¢ï¼Ÿ
<ul>
<li>é¿å…åå°„, æé«˜æ€§èƒ½, ä»£ä»·æ˜¯ä¸€ä¸ªä»£ç†ç±»é…ä¸¤ä¸ª FastClass ç±», ä»£ç†ç±»ä¸­è¿˜å¾—å¢åŠ ä»…è°ƒç”¨ super çš„ä¸€å †æ–¹æ³•</li>
<li>ç”¨ç¼–å·å¤„ç†æ–¹æ³•å¯¹åº”å…³ç³»æ¯”è¾ƒçœå†…å­˜, å¦å¤–, æœ€åˆè·å¾—æ–¹æ³•é¡ºåºæ˜¯ä¸ç¡®å®šçš„, è¿™ä¸ªè¿‡ç¨‹æ²¡æ³•å›ºå®šæ­»</li>
</ul>
</li>
</ol>
<h3 id="_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€" tabindex="-1"><a class="header-anchor" href="#_15-jdk-å’Œ-cglib-åœ¨-spring-ä¸­çš„ç»Ÿä¸€"><span>15) jdk å’Œ cglib åœ¨ Spring ä¸­çš„ç»Ÿä¸€</span></a></h3>
<p>Spring ä¸­å¯¹åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢çš„æŠ½è±¡å¦‚ä¸‹</p>
<ul>
<li>åˆ‡ç‚¹ï¼šæ¥å£ Pointcutï¼Œå…¸å‹å®ç° AspectJExpressionPointcut</li>
<li>é€šçŸ¥ï¼šå…¸å‹æ¥å£ä¸º MethodInterceptor ä»£è¡¨ç¯ç»•é€šçŸ¥</li>
<li>åˆ‡é¢ï¼šAdvisorï¼ŒåŒ…å«ä¸€ä¸ª Advice é€šçŸ¥ï¼ŒPointcutAdvisor åŒ…å«ä¸€ä¸ª Advice é€šçŸ¥å’Œä¸€ä¸ª Pointcut</li>
</ul>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class Advice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class MethodInterceptor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class Advisor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class PointcutAdvisor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Pointcut &#x3C;|-- AspectJExpressionPointcut</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Advice &#x3C;|-- MethodInterceptor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Advisor &#x3C;|-- PointcutAdvisor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">PointcutAdvisor o-- "ä¸€" Pointcut</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">PointcutAdvisor o-- "ä¸€" Advice</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Advice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> MethodInterceptor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Pointcut</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Advisor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> PointcutAdvisor</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç†ç›¸å…³ç±»å›¾</p>
<ul>
<li>AopProxyFactory æ ¹æ® proxyTargetClass ç­‰è®¾ç½®é€‰æ‹© AopProxy å®ç°</li>
<li>AopProxy é€šè¿‡ getProxy åˆ›å»ºä»£ç†å¯¹è±¡</li>
<li>å›¾ä¸­ Proxy éƒ½å®ç°äº† Advised æ¥å£ï¼Œèƒ½å¤Ÿè·å¾—å…³è”çš„åˆ‡é¢é›†åˆä¸ç›®æ ‡ï¼ˆå…¶å®æ˜¯ä» ProxyFactory å–å¾—ï¼‰</li>
<li>è°ƒç”¨ä»£ç†æ–¹æ³•æ—¶ï¼Œä¼šå€ŸåŠ© ProxyFactory å°†é€šçŸ¥ç»Ÿä¸€è½¬ä¸ºç¯ç»•é€šçŸ¥ï¼šMethodInterceptor</li>
</ul>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Advised &#x3C;|-- ProxyFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ProxyFactory o-- Target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ProxyFactory o-- "å¤š" Advisor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ProxyFactory --> AopProxyFactory : ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">AopProxyFactory --> AopProxy</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Advised &#x3C;|-- åŸºäºCGLIBçš„Proxy</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">åŸºäºCGLIBçš„Proxy &#x3C;-- ObjenesisCglibAopProxy : åˆ›å»º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">AopProxy &#x3C;|-- ObjenesisCglibAopProxy</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">AopProxy &#x3C;|-- JdkDynamicAopProxy</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">åŸºäºJDKçš„Proxy &#x3C;-- JdkDynamicAopProxy : åˆ›å»º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Advised &#x3C;|-- åŸºäºJDKçš„Proxy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class AopProxy {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   +getProxy() Object</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class ProxyFactory {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">	proxyTargetClass : boolean</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class ObjenesisCglibAopProxy {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">	advised : ProxyFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class JdkDynamicAopProxy {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">	advised : ProxyFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Advised</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> AopProxyFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> AopProxy</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢"><span>æ¼”ç¤º - åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-18" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-18"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a15.A15</strong></p>
<h4 id="æ”¶è·ğŸ’¡-23" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-23"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>åº•å±‚çš„åˆ‡ç‚¹å®ç°</li>
<li>åº•å±‚çš„é€šçŸ¥å®ç°</li>
<li>åº•å±‚çš„åˆ‡é¢å®ç°</li>
<li>ProxyFactory ç”¨æ¥åˆ›å»ºä»£ç†
<ul>
<li>å¦‚æœæŒ‡å®šäº†æ¥å£ï¼Œä¸” proxyTargetClass = falseï¼Œä½¿ç”¨ JdkDynamicAopProxy</li>
<li>å¦‚æœæ²¡æœ‰æŒ‡å®šæ¥å£ï¼Œæˆ–è€… proxyTargetClass = trueï¼Œä½¿ç”¨ ObjenesisCglibAopProxy
<ul>
<li>ä¾‹å¤–ï¼šå¦‚æœç›®æ ‡æ˜¯æ¥å£ç±»å‹æˆ–å·²ç»æ˜¯ Jdk ä»£ç†ï¼Œä½¿ç”¨ JdkDynamicAopProxy</li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>è¦åŒºåˆ†æœ¬ç« èŠ‚æåˆ°çš„ MethodInterceptorï¼Œå®ƒä¸ä¹‹å‰ cglib ä¸­ç”¨çš„çš„ MethodInterceptor æ˜¯ä¸åŒçš„æ¥å£</li>
</ul>
</blockquote>
<h3 id="_16-åˆ‡ç‚¹åŒ¹é…" tabindex="-1"><a class="header-anchor" href="#_16-åˆ‡ç‚¹åŒ¹é…"><span>16) åˆ‡ç‚¹åŒ¹é…</span></a></h3>
<h4 id="æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…"><span>æ¼”ç¤º - åˆ‡ç‚¹åŒ¹é…</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-19" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-19"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a16.A16</strong></p>
<h4 id="æ”¶è·ğŸ’¡-24" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-24"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å¸¸è§ aspectj åˆ‡ç‚¹ç”¨æ³•</li>
<li>aspectj åˆ‡ç‚¹çš„å±€é™æ€§ï¼Œå®é™…çš„ @Transactional åˆ‡ç‚¹å®ç°</li>
</ol>
<h3 id="_17-ä»-aspect-åˆ°-advisor" tabindex="-1"><a class="header-anchor" href="#_17-ä»-aspect-åˆ°-advisor"><span>17) ä» @Aspect åˆ° Advisor</span></a></h3>
<h4 id="æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨"><span>æ¼”ç¤º1 - ä»£ç†åˆ›å»ºå™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-20" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-20"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.autoproxy</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-25" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-25"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>AnnotationAwareAspectJAutoProxyCreator çš„ä½œç”¨
<ul>
<li>å°†é«˜çº§ @Aspect åˆ‡é¢ç»Ÿä¸€ä¸ºä½çº§ Advisor åˆ‡é¢</li>
<li>åœ¨åˆé€‚çš„æ—¶æœºåˆ›å»ºä»£ç†</li>
</ul>
</li>
<li>findEligibleAdvisors æ‰¾åˆ°æœ‰ã€èµ„æ ¼ã€‘çš„ Advisors
<ul>
<li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor ä¸€éƒ¨åˆ†æ˜¯ä½çº§çš„, å¯ä»¥ç”±è‡ªå·±ç¼–å†™, å¦‚æœ¬ä¾‹ A17 ä¸­çš„ advisor3</li>
<li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor å¦ä¸€éƒ¨åˆ†æ˜¯é«˜çº§çš„, ç”±è§£æ @Aspect åè·å¾—</li>
</ul>
</li>
<li>wrapIfNecessary
<ul>
<li>å®ƒå†…éƒ¨è°ƒç”¨ findEligibleAdvisors, åªè¦è¿”å›é›†åˆä¸ç©º, åˆ™è¡¨ç¤ºéœ€è¦åˆ›å»ºä»£ç†</li>
<li>å®ƒçš„è°ƒç”¨æ—¶æœºé€šå¸¸åœ¨åŸå§‹å¯¹è±¡åˆå§‹åŒ–åæ‰§è¡Œ, ä½†ç¢°åˆ°å¾ªç¯ä¾èµ–ä¼šæå‰è‡³ä¾èµ–æ³¨å…¥ä¹‹å‰æ‰§è¡Œ</li>
</ul>
</li>
</ol>
<h4 id="æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº"><span>æ¼”ç¤º2 - ä»£ç†åˆ›å»ºæ—¶æœº</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-21" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-21"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.autoproxy.A17_1</strong></p>
<h4 id="æ”¶è·ğŸ’¡-26" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-26"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ä»£ç†çš„åˆ›å»ºæ—¶æœº
<ul>
<li>åˆå§‹åŒ–ä¹‹å (æ— å¾ªç¯ä¾èµ–æ—¶)</li>
<li>å®ä¾‹åˆ›å»ºå, ä¾èµ–æ³¨å…¥å‰ (æœ‰å¾ªç¯ä¾èµ–æ—¶), å¹¶æš‚å­˜äºäºŒçº§ç¼“å­˜</li>
</ul>
</li>
<li>ä¾èµ–æ³¨å…¥ä¸åˆå§‹åŒ–ä¸åº”è¯¥è¢«å¢å¼º, ä»åº”è¢«æ–½åŠ äºåŸå§‹å¯¹è±¡</li>
</ol>
<h4 id="æ¼”ç¤º3-before-å¯¹åº”çš„ä½çº§é€šçŸ¥" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º3-before-å¯¹åº”çš„ä½çº§é€šçŸ¥"><span>æ¼”ç¤º3 - @Before å¯¹åº”çš„ä½çº§é€šçŸ¥</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-22" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-22"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.autoproxy.A17_2</strong></p>
<h4 id="æ”¶è·ğŸ’¡-27" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-27"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>@Before å‰ç½®é€šçŸ¥ä¼šè¢«è½¬æ¢ä¸ºåŸå§‹çš„ AspectJMethodBeforeAdvice å½¢å¼, è¯¥å¯¹è±¡åŒ…å«äº†å¦‚ä¸‹ä¿¡æ¯
<ol>
<li>é€šçŸ¥ä»£ç ä»å“ªå„¿æ¥</li>
<li>åˆ‡ç‚¹æ˜¯ä»€ä¹ˆ(è¿™é‡Œä¸ºå•¥è¦åˆ‡ç‚¹, åé¢è§£é‡Š)</li>
<li>é€šçŸ¥å¯¹è±¡å¦‚ä½•åˆ›å»º, æœ¬ä¾‹å…±ç”¨åŒä¸€ä¸ª Aspect å¯¹è±¡</li>
</ol>
</li>
<li>ç±»ä¼¼çš„è¿˜æœ‰
<ol>
<li>AspectJAroundAdvice (ç¯ç»•é€šçŸ¥)</li>
<li>AspectJAfterReturningAdvice</li>
<li>AspectJAfterThrowingAdvice (ç¯ç»•é€šçŸ¥)</li>
<li>AspectJAfterAdvice (ç¯ç»•é€šçŸ¥)</li>
</ol>
</li>
</ol>
<h3 id="_18-é™æ€é€šçŸ¥è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_18-é™æ€é€šçŸ¥è°ƒç”¨"><span>18) é™æ€é€šçŸ¥è°ƒç”¨</span></a></h3>
<p>ä»£ç†å¯¹è±¡è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼ˆä»¥ JDK åŠ¨æ€ä»£ç†å®ç°ä¸ºä¾‹ï¼‰</p>
<ul>
<li>ä» ProxyFactory è·å¾— Target å’Œç¯ç»•é€šçŸ¥é“¾ï¼Œæ ¹æ®ä»–ä¿©åˆ›å»º MethodInvocationï¼Œç®€ç§° mi</li>
<li>é¦–æ¬¡æ‰§è¡Œ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li>
<li>è¿›å…¥ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œå†æ¬¡è°ƒç”¨ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li>
<li>è¿›å…¥ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œè°ƒç”¨ mi.proceed() å‘ç°æ²¡æœ‰ç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨ mi.invokeJoinPoint() æ‰§è¡Œç›®æ ‡æ–¹æ³•</li>
<li>ç›®æ ‡æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥2 çš„åå¢å¼º</li>
<li>ç¯ç»•é€šçŸ¥2ç»§ç»­å°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥1 çš„åå¢å¼º</li>
<li>ç¯ç»•é€šçŸ¥1è¿”å›æœ€ç»ˆçš„ç»“æœ</li>
</ul>
<p>å›¾ä¸­ä¸åŒé¢œè‰²å¯¹åº”ä¸€æ¬¡ç¯ç»•é€šçŸ¥æˆ–ç›®æ ‡çš„è°ƒç”¨èµ·å§‹è‡³ç»ˆç»“</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant Proxy</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ih as InvocationHandler</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mi as MethodInvocation</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant Factory as ProxyFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mi1 as MethodInterceptor1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mi2 as MethodInterceptor2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant Target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Proxy ->> +ih : invoke()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ih ->> +Factory : è·å¾— Target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Factory -->> -ih : </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ih ->> +Factory : è·å¾— MethodInterceptor é“¾</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Factory -->> -ih : </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ih ->> +mi : åˆ›å»º mi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi -->> -ih : </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(200, 223, 255)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ih ->> +mi : mi.proceed()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi ->> +mi1 : invoke(mi)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi1 ->> mi1 : å‰å¢å¼º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(200, 190, 255)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi1 ->> mi : mi.proceed()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi ->> +mi2 : invoke(mi)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi2 ->> mi2 : å‰å¢å¼º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(150, 190, 155)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi2 ->> mi : mi.proceed()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi ->> +Target : mi.invokeJoinPoint()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Target ->> Target : </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Target -->> -mi2 : ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi2 ->> mi2 : åå¢å¼º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi2 -->> -mi1 : ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi1 ->> mi1 : åå¢å¼º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi1 -->> -mi : ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mi -->> -ih : </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ih -->> -Proxy :</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹"><span>æ¼”ç¤º1 - é€šçŸ¥è°ƒç”¨è¿‡ç¨‹</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-23" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-23"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.A18</strong></p>
<h4 id="æ”¶è·ğŸ’¡-28" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-28"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>ä»£ç†æ–¹æ³•æ‰§è¡Œæ—¶ä¼šåšå¦‚ä¸‹å·¥ä½œ</p>
<ol>
<li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥
<ul>
<li>MethodBeforeAdviceAdapter å°† @Before AspectJMethodBeforeAdvice é€‚é…ä¸º MethodBeforeAdviceInterceptor</li>
<li>AfterReturningAdviceAdapter å°† @AfterReturning AspectJAfterReturningAdvice é€‚é…ä¸º AfterReturningAdviceInterceptor</li>
<li>è¿™ä½“ç°çš„æ˜¯é€‚é…å™¨è®¾è®¡æ¨¡å¼</li>
</ul>
</li>
<li>æ‰€è°“é™æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ Interceptors éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶æ— éœ€å†æ¬¡æ£€æŸ¥åˆ‡ç‚¹ï¼Œç›´æ¥è°ƒç”¨å³å¯</li>
<li>ç»“åˆç›®æ ‡ä¸ç¯ç»•é€šçŸ¥é“¾ï¼Œåˆ›å»º MethodInvocation å¯¹è±¡ï¼Œé€šè¿‡å®ƒå®Œæˆæ•´ä¸ªè°ƒç”¨</li>
</ol>
<h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿ-methodinvocation" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-æ¨¡æ‹Ÿ-methodinvocation"><span>æ¼”ç¤º2 - æ¨¡æ‹Ÿ MethodInvocation</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-24" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-24"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.A18_1</strong></p>
<h4 id="æ”¶è·ğŸ’¡-29" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-29"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>proceed() æ–¹æ³•è°ƒç”¨é“¾ä¸­ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥</li>
<li>æ¯ä¸ªç¯ç»•é€šçŸ¥å†…éƒ¨ç»§ç»­è°ƒç”¨ proceed()</li>
<li>è°ƒç”¨åˆ°æ²¡æœ‰æ›´å¤šé€šçŸ¥äº†, å°±è°ƒç”¨ç›®æ ‡æ–¹æ³•</li>
</ol>
<p>MethodInvocation çš„ç¼–ç¨‹æŠ€å·§åœ¨å®ç°æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ—¶èƒ½ç”¨ä¸Š</p>
<h3 id="_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_19-åŠ¨æ€é€šçŸ¥è°ƒç”¨"><span>19) åŠ¨æ€é€šçŸ¥è°ƒç”¨</span></a></h3>
<h4 id="æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨"><span>æ¼”ç¤º - å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-25" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-25"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.aop.framework.autoproxy.A19</strong></p>
<h4 id="æ”¶è·ğŸ’¡-30" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-30"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥</li>
<li>æ‰€è°“åŠ¨æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ DynamicInterceptionAdvice éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶å› ä¸ºè¦ä¸ºé€šçŸ¥æ–¹æ³•ç»‘å®šå‚æ•°ï¼Œè¿˜éœ€å†æ¬¡åˆ©ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼</li>
<li>åŠ¨æ€é€šçŸ¥è°ƒç”¨å¤æ‚ç¨‹åº¦é«˜ï¼Œæ€§èƒ½è¾ƒä½</li>
</ol>
<h2 id="web" tabindex="-1"><a class="header-anchor" href="#web"><span>WEB</span></a></h2>
<h3 id="_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter" tabindex="-1"><a class="header-anchor" href="#_20-requestmappinghandlermapping-ä¸-requestmappinghandleradapter"><span>20) RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter</span></a></h3>
<p>RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter ä¿©æ˜¯ä¸€å¯¹ï¼Œåˆ†åˆ«ç”¨æ¥</p>
<ul>
<li>å¤„ç† @RequestMapping æ˜ å°„</li>
<li>è°ƒç”¨æ§åˆ¶å™¨æ–¹æ³•ã€å¹¶å¤„ç†æ–¹æ³•å‚æ•°ä¸æ–¹æ³•è¿”å›å€¼</li>
</ul>
<h4 id="æ¼”ç¤º1-dispatcherservlet-åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-dispatcherservlet-åˆå§‹åŒ–"><span>æ¼”ç¤º1 - DispatcherServlet åˆå§‹åŒ–</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-26" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-26"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a20</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-31" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-31"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>DispatcherServlet æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶æ‰§è¡Œåˆå§‹åŒ–, ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹ä¸º Tomcat å¯åŠ¨åå°±åˆå§‹åŒ–</li>
<li>åœ¨åˆå§‹åŒ–æ—¶ä¼šä» Spring å®¹å™¨ä¸­æ‰¾ä¸€äº› Web éœ€è¦çš„ç»„ä»¶, å¦‚ HandlerMappingã€HandlerAdapter ç­‰ï¼Œå¹¶é€ä¸€è°ƒç”¨å®ƒä»¬çš„åˆå§‹åŒ–</li>
<li>RequestMappingHandlerMapping åˆå§‹åŒ–æ—¶ï¼Œä¼šæ”¶é›†æ‰€æœ‰ @RequestMapping æ˜ å°„ä¿¡æ¯ï¼Œå°è£…ä¸º Mapï¼Œå…¶ä¸­
<ul>
<li>key æ˜¯ RequestMappingInfo ç±»å‹ï¼ŒåŒ…æ‹¬è¯·æ±‚è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ç­‰ä¿¡æ¯</li>
<li>value æ˜¯ HandlerMethod ç±»å‹ï¼ŒåŒ…æ‹¬æ§åˆ¶å™¨æ–¹æ³•å¯¹è±¡ã€æ§åˆ¶å™¨å¯¹è±¡</li>
<li>æœ‰äº†è¿™ä¸ª Mapï¼Œå°±å¯ä»¥åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå¿«é€Ÿå®Œæˆæ˜ å°„ï¼Œæ‰¾åˆ° HandlerMethod å¹¶ä¸åŒ¹é…çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet</li>
</ul>
</li>
<li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ï¼Œä¼šå‡†å¤‡ HandlerMethod è°ƒç”¨æ—¶éœ€è¦çš„å„ä¸ªç»„ä»¶ï¼Œå¦‚ï¼š
<ul>
<li>HandlerMethodArgumentResolver è§£ææ§åˆ¶å™¨æ–¹æ³•å‚æ•°</li>
<li>HandlerMethodReturnValueHandler å¤„ç†æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼</li>
</ul>
</li>
</ol>
<h4 id="æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨"><span>æ¼”ç¤º2 - è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-27" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-27"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a20.TokenArgumentResolver</strong> ï¼Œ<strong>com.itheima.a20.YmlReturnValueHandler</strong></p>
<h4 id="æ”¶è·ğŸ’¡-32" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-32"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ä½“ä¼šå‚æ•°è§£æå™¨çš„ä½œç”¨</li>
<li>ä½“ä¼šè¿”å›å€¼å¤„ç†å™¨çš„ä½œç”¨</li>
</ol>
<h3 id="_21-å‚æ•°è§£æå™¨" tabindex="-1"><a class="header-anchor" href="#_21-å‚æ•°è§£æå™¨"><span>21) å‚æ•°è§£æå™¨</span></a></h3>
<h4 id="æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨"><span>æ¼”ç¤º - å¸¸è§å‚æ•°è§£æå™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-28" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-28"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a21</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-33" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-33"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>åˆæ­¥äº†è§£ RequestMappingHandlerAdapter çš„è°ƒç”¨è¿‡ç¨‹
<ol>
<li>æ§åˆ¶å™¨æ–¹æ³•è¢«å°è£…ä¸º HandlerMethod</li>
<li>å‡†å¤‡å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</li>
<li>å‡†å¤‡ ModelAndViewContainer ç”¨æ¥å­˜å‚¨ä¸­é—´ Model ç»“æœ</li>
<li>è§£ææ¯ä¸ªå‚æ•°å€¼</li>
</ol>
</li>
<li>è§£æå‚æ•°ä¾èµ–çš„å°±æ˜¯å„ç§å‚æ•°è§£æå™¨ï¼Œå®ƒä»¬éƒ½æœ‰ä¸¤ä¸ªé‡è¦æ–¹æ³•
<ul>
<li>supportsParameter åˆ¤æ–­æ˜¯å¦æ”¯æŒæ–¹æ³•å‚æ•°</li>
<li>resolveArgument è§£ææ–¹æ³•å‚æ•°</li>
</ul>
</li>
<li>å¸¸è§å‚æ•°çš„è§£æ
<ul>
<li>@RequestParam</li>
<li>çœç•¥ @RequestParam</li>
<li>@RequestParam(defaultValue)</li>
<li>MultipartFile</li>
<li>@PathVariable</li>
<li>@RequestHeader</li>
<li>@CookieValue</li>
<li>@Value</li>
<li>HttpServletRequest ç­‰</li>
<li>@ModelAttribute</li>
<li>çœç•¥ @ModelAttribute</li>
<li>@RequestBody</li>
</ul>
</li>
<li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç°</li>
<li>@RequestParam, @CookieValue ç­‰æ³¨è§£ä¸­çš„å‚æ•°åã€é»˜è®¤å€¼, éƒ½å¯ä»¥å†™æˆæ´»çš„, å³ä» ${ } #{ }ä¸­è·å–</li>
</ol>
<h3 id="_22-å‚æ•°åè§£æ" tabindex="-1"><a class="header-anchor" href="#_22-å‚æ•°åè§£æ"><span>22) å‚æ•°åè§£æ</span></a></h3>
<h4 id="æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å"><span>æ¼”ç¤º - ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-29" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-29"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a22.A22</strong></p>
<h4 id="æ”¶è·ğŸ’¡-34" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-34"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -parameters å¯ä»¥ç”Ÿæˆå‚æ•°è¡¨, åå°„æ—¶å°±å¯ä»¥æ‹¿åˆ°å‚æ•°å</li>
<li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -g å¯ä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯, ä½†åˆ†ä¸ºä¸¤ç§æƒ…å†µ
<ul>
<li>æ™®é€šç±», ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, ç”¨ asm å¯ä»¥æ‹¿åˆ°å‚æ•°å</li>
<li>æ¥å£, ä¸ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, æ— æ³•è·å¾—å‚æ•°å
<ul>
<li>è¿™ä¹Ÿæ˜¯ MyBatis åœ¨å®ç° Mapper æ¥å£æ—¶ä¸ºä½•è¦æä¾› @Param æ³¨è§£æ¥è¾…åŠ©è·å¾—å‚æ•°å</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#_23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢"><span>23) å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</span></a></h3>
<h4 id="åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°" tabindex="-1"><a class="header-anchor" href="#åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°"><span>åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Formatter --|> Printer</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Formatter --|> Parser</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class Converters {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   Set~GenericConverter~</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class Converter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class ConversionService</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class FormattingConversionService</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ConversionService &#x3C;|-- FormattingConversionService</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">FormattingConversionService o-- Converters</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Printer --> Adapter1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Adapter1 --> Converters</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Parser --> Adapter2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Adapter2 --> Converters</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Converter --> Adapter3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">Adapter3 --> Converters</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Formatter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Printer</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Parser</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> Converter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> ConversionService</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>Printer æŠŠå…¶å®ƒç±»å‹è½¬ä¸º String</li>
<li>Parser æŠŠ String è½¬ä¸ºå…¶å®ƒç±»å‹</li>
<li>Formatter ç»¼åˆ Printer ä¸ Parser åŠŸèƒ½</li>
<li>Converter æŠŠç±»å‹ S è½¬ä¸ºç±»å‹ T</li>
<li>Printerã€Parserã€Converter ç»è¿‡é€‚é…è½¬æ¢æˆ GenericConverter æ”¾å…¥ Converters é›†åˆ</li>
<li>FormattingConversionService åˆ©ç”¨å…¶å®ƒä»¬å®ç°è½¬æ¢</li>
</ul>
<h4 id="åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£" tabindex="-1"><a class="header-anchor" href="#åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£"><span>åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">PropertyEditorRegistry o-- "å¤š" PropertyEditor</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> PropertyEditorRegistry</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> PropertyEditor</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>PropertyEditor æŠŠ String ä¸å…¶å®ƒç±»å‹ç›¸äº’è½¬æ¢</li>
<li>PropertyEditorRegistry å¯ä»¥æ³¨å†Œå¤šä¸ª PropertyEditor å¯¹è±¡</li>
<li>ä¸ç¬¬ä¸€å¥—æ¥å£ç›´æ¥å¯ä»¥é€šè¿‡ FormatterPropertyEditorAdapter æ¥è¿›è¡Œé€‚é…</li>
</ul>
<h4 id="é«˜å±‚æ¥å£ä¸å®ç°" tabindex="-1"><a class="header-anchor" href="#é«˜å±‚æ¥å£ä¸å®ç°"><span>é«˜å±‚æ¥å£ä¸å®ç°</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverter &#x3C;|-- SimpleTypeConverter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverter &#x3C;|-- BeanWrapperImpl</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverter &#x3C;|-- DirectFieldAccessor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverter &#x3C;|-- ServletRequestDataBinder</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">SimpleTypeConverter --> TypeConverterDelegate</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">BeanWrapperImpl --> TypeConverterDelegate</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">DirectFieldAccessor --> TypeConverterDelegate</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ServletRequestDataBinder --> TypeConverterDelegate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverterDelegate --> ConversionService</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">TypeConverterDelegate --> PropertyEditorRegistry</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> TypeConverter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> ConversionService</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;&#x3C;interface>> PropertyEditorRegistry</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>å®ƒä»¬éƒ½å®ç°äº† TypeConverter è¿™ä¸ªé«˜å±‚è½¬æ¢æ¥å£ï¼Œåœ¨è½¬æ¢æ—¶ï¼Œä¼šç”¨åˆ° TypeConverter Delegate å§”æ´¾ConversionService ä¸ PropertyEditorRegistry çœŸæ­£æ‰§è¡Œè½¬æ¢ï¼ˆFacade é—¨é¢æ¨¡å¼ï¼‰
<ul>
<li>é¦–å…ˆçœ‹æ˜¯å¦æœ‰è‡ªå®šä¹‰è½¬æ¢å™¨, @InitBinder æ·»åŠ çš„å³å±äºè¿™ç§ (ç”¨äº†é€‚é…å™¨æ¨¡å¼æŠŠ Formatter è½¬ä¸ºéœ€è¦çš„ PropertyEditor)</li>
<li>å†çœ‹æœ‰æ²¡æœ‰ ConversionService è½¬æ¢</li>
<li>å†åˆ©ç”¨é»˜è®¤çš„ PropertyEditor è½¬æ¢</li>
<li>æœ€åæœ‰ä¸€äº›ç‰¹æ®Šå¤„ç†</li>
</ul>
</li>
<li>SimpleTypeConverter ä»…åšç±»å‹è½¬æ¢</li>
<li>BeanWrapperImpl ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Property</li>
<li>DirectFieldAccessor ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Field</li>
<li>ServletRequestDataBinder ä¸º bean çš„å±æ€§æ‰§è¡Œç»‘å®šï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œæ ¹æ® directFieldAccess é€‰æ‹©èµ° Property è¿˜æ˜¯ Fieldï¼Œå…·å¤‡æ ¡éªŒä¸è·å–æ ¡éªŒç»“æœåŠŸèƒ½</li>
</ul>
<h4 id="æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š"><span>æ¼”ç¤º1 - ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-30" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-30"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a23</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-35" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-35"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>åŸºæœ¬çš„ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®šç”¨æ³•</p>
<ul>
<li>SimpleTypeConverter</li>
<li>BeanWrapperImpl</li>
<li>DirectFieldAccessor</li>
<li>ServletRequestDataBinder</li>
</ul>
<h4 id="æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚"><span>æ¼”ç¤º2 - æ•°æ®ç»‘å®šå·¥å‚</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-31" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-31"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a23.TestServletDataBinderFactory</strong></p>
<h4 id="æ”¶è·ğŸ’¡-36" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-36"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>ServletRequestDataBinderFactory çš„ç”¨æ³•å’Œæ‰©å±•ç‚¹</p>
<ol>
<li>å¯ä»¥è§£ææ§åˆ¶å™¨çš„ @InitBinder æ ‡æ³¨æ–¹æ³•ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨
<ul>
<li>æ§åˆ¶å™¨ç§æœ‰èŒƒå›´</li>
</ul>
</li>
<li>å¯ä»¥é€šè¿‡ ConfigurableWebBindingInitializer é…ç½® ConversionService ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨
<ul>
<li>å…¬å…±èŒƒå›´</li>
</ul>
</li>
<li>åŒæ—¶åŠ äº† @InitBinder å’Œ ConversionService çš„è½¬æ¢ä¼˜å…ˆçº§
<ol>
<li>ä¼˜å…ˆé‡‡ç”¨ @InitBinder çš„è½¬æ¢å™¨</li>
<li>å…¶æ¬¡ä½¿ç”¨ ConversionService çš„è½¬æ¢å™¨</li>
<li>ä½¿ç”¨é»˜è®¤è½¬æ¢å™¨</li>
<li>ç‰¹æ®Šå¤„ç†ï¼ˆä¾‹å¦‚æœ‰å‚æ„é€ ï¼‰</li>
</ol>
</li>
</ol>
<h4 id="æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°"><span>æ¼”ç¤º3 - è·å–æ³›å‹å‚æ•°</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-32" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-32"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a23.sub</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-37" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-37"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>java api è·å–æ³›å‹å‚æ•°</li>
<li>spring api è·å–æ³›å‹å‚æ•°</li>
</ol>
<h3 id="_24-controlleradvice-ä¹‹-initbinder" tabindex="-1"><a class="header-anchor" href="#_24-controlleradvice-ä¹‹-initbinder"><span>24) @ControllerAdvice ä¹‹ @InitBinder</span></a></h3>
<h4 id="æ¼”ç¤º-å‡†å¤‡-initbinder" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å‡†å¤‡-initbinder"><span>æ¼”ç¤º - å‡†å¤‡ @InitBinder</span></a></h4>
<p><strong>å‡†å¤‡ @InitBinder</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant adapter as HandlerAdapter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bf as WebDataBinderFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mf as ModelFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ihm as ServletInvocableHandlerMethod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ar as ArgumentResolvers </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant rh as ReturnValueHandlers</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant container as ModelAndViewContainer</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(200, 150, 255)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +bf: å‡†å¤‡ @InitBinder</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +mf: å‡†å¤‡ @ModelAttribute</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf ->> +container: æ·»åŠ Modelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -mf: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf -->> -adapter: </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +ihm: invokeAndHandle</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +ar: è·å– args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar -->> -ihm: args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +rh: å¤„ç† returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -rh: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh -->> -ihm: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +container: è·å– ModelAndView</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -adapter:</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>RequestMappingHandlerAdapter åœ¨å›¾ä¸­ç¼©å†™ä¸º HandlerAdapter</li>
<li>HandlerMethodArgumentResolverComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ArgumentResolvers</li>
<li>HandlerMethodReturnValueHandlerComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ReturnValueHandlers</li>
</ul>
<h4 id="æ”¶è·ğŸ’¡-38" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-38"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•</li>
<li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @InitBinder æ–¹æ³•</li>
<li>ä»¥ä¸Šä¸¤ç§ @InitBinder çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li>
<li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @InitBinder æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•åˆ›å»ºç»‘å®šå·¥å‚</li>
</ol>
<h3 id="_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹"><span>25) æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹</span></a></h3>
<h4 id="å›¾1" tabindex="-1"><a class="header-anchor" href="#å›¾1"><span>å›¾1</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">classDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">class ServletInvocableHandlerMethod {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">	+invokeAndHandle(ServletWebRequest,ModelAndViewContainer)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">HandlerMethod &#x3C;|-- ServletInvocableHandlerMethod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">HandlerMethod o-- bean</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">HandlerMethod o-- method</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ServletInvocableHandlerMethod o-- WebDataBinderFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ServletInvocableHandlerMethod o-- ParameterNameDiscoverer</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ServletInvocableHandlerMethod o-- HandlerMethodArgumentResolverComposite</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ServletInvocableHandlerMethod o-- HandlerMethodReturnValueHandlerComposite</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HandlerMethod éœ€è¦</p>
<ul>
<li>bean å³æ˜¯å“ªä¸ª Controller</li>
<li>method å³æ˜¯ Controller ä¸­çš„å“ªä¸ªæ–¹æ³•</li>
</ul>
<p>ServletInvocableHandlerMethod éœ€è¦</p>
<ul>
<li>WebDataBinderFactory è´Ÿè´£å¯¹è±¡ç»‘å®šã€ç±»å‹è½¬æ¢</li>
<li>ParameterNameDiscoverer è´Ÿè´£å‚æ•°åè§£æ</li>
<li>HandlerMethodArgumentResolverComposite è´Ÿè´£è§£æå‚æ•°</li>
<li>HandlerMethodReturnValueHandlerComposite è´Ÿè´£å¤„ç†è¿”å›å€¼</li>
</ul>
<h4 id="å›¾2" tabindex="-1"><a class="header-anchor" href="#å›¾2"><span>å›¾2</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant adapter as RequestMappingHandlerAdapter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bf as WebDataBinderFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mf as ModelFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant container as ModelAndViewContainer</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +bf: å‡†å¤‡ @InitBinder</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +mf: å‡†å¤‡ @ModelAttribute</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf ->> +container: æ·»åŠ Modelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -mf: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf -->> -adapter:</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å›¾3" tabindex="-1"><a class="header-anchor" href="#å›¾3"><span>å›¾3</span></a></h4>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant adapter as RequestMappingHandlerAdapter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ihm as ServletInvocableHandlerMethod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ar as ArgumentResolvers</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant rh as ReturnValueHandlers</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant container as ModelAndViewContainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +ihm: invokeAndHandle</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +ar: è·å– args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”Ÿæˆæ¨¡å‹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> ar: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar -->> -ihm: args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +rh: å¤„ç† returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -rh: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh -->> -ihm: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +container: è·å– ModelAndView</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -adapter:</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_26-controlleradvice-ä¹‹-modelattribute" tabindex="-1"><a class="header-anchor" href="#_26-controlleradvice-ä¹‹-modelattribute"><span>26) @ControllerAdvice ä¹‹ @ModelAttribute</span></a></h3>
<h4 id="æ¼”ç¤º-å‡†å¤‡-modelattribute" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å‡†å¤‡-modelattribute"><span>æ¼”ç¤º - å‡†å¤‡ @ModelAttribute</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-33" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-33"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a26</strong> åŒ…</p>
<p><strong>å‡†å¤‡ @ModelAttribute</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant adapter as HandlerAdapter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bf as WebDataBinderFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mf as ModelFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ihm as ServletInvocableHandlerMethod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ar as ArgumentResolvers </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant rh as ReturnValueHandlers</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant container as ModelAndViewContainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +bf: å‡†å¤‡ @InitBinder</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(200, 150, 255)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +mf: å‡†å¤‡ @ModelAttribute</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf ->> +container: æ·»åŠ Modelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -mf: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +ihm: invokeAndHandle</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +ar: è·å– args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar -->> -ihm: args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +rh: å¤„ç† returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -rh: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh -->> -ihm: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +container: è·å– ModelAndView</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -adapter:</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-39" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-39"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•</li>
<li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ModelAttribute æ–¹æ³•</li>
<li>ä»¥ä¸Šä¸¤ç§ @ModelAttribute çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li>
<li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @ModelAttribute æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•åˆ›å»ºæ¨¡å‹å·¥å‚</li>
</ol>
<h3 id="_27-è¿”å›å€¼å¤„ç†å™¨" tabindex="-1"><a class="header-anchor" href="#_27-è¿”å›å€¼å¤„ç†å™¨"><span>27) è¿”å›å€¼å¤„ç†å™¨</span></a></h3>
<h4 id="æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨"><span>æ¼”ç¤º - å¸¸è§è¿”å›å€¼å¤„ç†å™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-34" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-34"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a27</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-40" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-40"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å¸¸è§çš„è¿”å›å€¼å¤„ç†å™¨
<ul>
<li>ModelAndViewï¼Œåˆ†åˆ«è·å–å…¶æ¨¡å‹å’Œè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li>
<li>è¿”å›å€¼ç±»å‹ä¸º String æ—¶ï¼ŒæŠŠå®ƒå½“åšè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li>
<li>è¿”å›å€¼æ·»åŠ äº† @ModelAttribute æ³¨è§£æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer
<ul>
<li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li>
</ul>
</li>
<li>è¿”å›å€¼çœç•¥ @ModelAttribute æ³¨è§£ä¸”è¿”å›éç®€å•ç±»å‹æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer
<ul>
<li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li>
</ul>
</li>
<li>è¿”å›å€¼ç±»å‹ä¸º ResponseEntity æ—¶
<ul>
<li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li>
</ul>
</li>
<li>è¿”å›å€¼ç±»å‹ä¸º HttpHeaders æ—¶
<ul>
<li>ä¼šè®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li>
</ul>
</li>
<li>è¿”å›å€¼æ·»åŠ äº† @ResponseBody æ³¨è§£æ—¶
<ul>
<li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li>
</ul>
</li>
</ul>
</li>
<li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç° + 1</li>
</ol>
<h3 id="_28-messageconverter" tabindex="-1"><a class="header-anchor" href="#_28-messageconverter"><span>28) MessageConverter</span></a></h3>
<h4 id="æ¼”ç¤º-messageconverter-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-messageconverter-çš„ä½œç”¨"><span>æ¼”ç¤º - MessageConverter çš„ä½œç”¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-35" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-35"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a28.A28</strong></p>
<h4 id="æ”¶è·ğŸ’¡-41" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-41"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>MessageConverter çš„ä½œç”¨
<ul>
<li>@ResponseBody æ˜¯è¿”å›å€¼å¤„ç†å™¨è§£æçš„</li>
<li>ä½†å…·ä½“è½¬æ¢å·¥ä½œæ˜¯ MessageConverter åšçš„</li>
</ul>
</li>
<li>å¦‚ä½•é€‰æ‹© MediaType
<ul>
<li>é¦–å…ˆçœ‹ @RequestMapping ä¸Šæœ‰æ²¡æœ‰æŒ‡å®š</li>
<li>å…¶æ¬¡çœ‹ request çš„ Accept å¤´æœ‰æ²¡æœ‰æŒ‡å®š</li>
<li>æœ€åæŒ‰ MessageConverter çš„é¡ºåº, è°èƒ½è°å…ˆè½¬æ¢</li>
</ul>
</li>
</ol>
<h3 id="_29-controlleradvice-ä¹‹-responsebodyadvice" tabindex="-1"><a class="header-anchor" href="#_29-controlleradvice-ä¹‹-responsebodyadvice"><span>29) @ControllerAdvice ä¹‹ ResponseBodyAdvice</span></a></h3>
<h4 id="æ¼”ç¤º-responsebodyadvice-å¢å¼º" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-responsebodyadvice-å¢å¼º"><span>æ¼”ç¤º - ResponseBodyAdvice å¢å¼º</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-36" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-36"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a29</strong> åŒ…</p>
<p><strong>ResponseBodyAdvice å¢å¼º</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p>
<div class="language-mermaid line-numbers-mode" data-highlighter="shiki" data-ext="mermaid" data-title="mermaid" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sequenceDiagram</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant adapter as HandlerAdapter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant bf as WebDataBinderFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant mf as ModelFactory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ihm as ServletInvocableHandlerMethod</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant ar as ArgumentResolvers </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant rh as ReturnValueHandlers</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">participant container as ModelAndViewContainer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +bf: å‡†å¤‡ @InitBinder</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">bf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +mf: å‡†å¤‡ @ModelAttribute</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf ->> +container: æ·»åŠ Modelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -mf: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">mf -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +ihm: invokeAndHandle</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +ar: è·å– args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar ->> container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ar -->> -ihm: args</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm ->> +rh: å¤„ç† returnValue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rect rgb(200, 150, 255)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">end</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh ->> +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -rh: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">rh -->> -ihm: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">ihm -->> -adapter: </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">adapter ->> +container: è·å– ModelAndView</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">container -->> -adapter:</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-42" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-42"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ResponseBodyAdvice è¿”å›å“åº”ä½“å‰åŒ…è£…</li>
</ol>
<h3 id="_30-å¼‚å¸¸è§£æå™¨" tabindex="-1"><a class="header-anchor" href="#_30-å¼‚å¸¸è§£æå™¨"><span>30) å¼‚å¸¸è§£æå™¨</span></a></h3>
<h4 id="æ¼”ç¤º-exceptionhandlerexceptionresolver" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-exceptionhandlerexceptionresolver"><span>æ¼”ç¤º - ExceptionHandlerExceptionResolver</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-37" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-37"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a30.A30</strong></p>
<h4 id="æ”¶è·ğŸ’¡-43" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-43"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å®ƒèƒ½å¤Ÿé‡ç”¨å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ï¼Œå®ç°ç»„ä»¶é‡ç”¨</li>
<li>å®ƒèƒ½å¤Ÿæ”¯æŒåµŒå¥—å¼‚å¸¸</li>
</ol>
<h3 id="_31-controlleradvice-ä¹‹-exceptionhandler" tabindex="-1"><a class="header-anchor" href="#_31-controlleradvice-ä¹‹-exceptionhandler"><span>31) @ControllerAdvice ä¹‹ @ExceptionHandler</span></a></h3>
<h4 id="æ¼”ç¤º-å‡†å¤‡-exceptionhandler" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å‡†å¤‡-exceptionhandler"><span>æ¼”ç¤º - å‡†å¤‡ @ExceptionHandler</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-38" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-38"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a31</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-44" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-44"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ExceptionHandlerExceptionResolver åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ExceptionHandler æ–¹æ³•</li>
<li>ExceptionHandlerExceptionResolver ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡å¤„ç†å¼‚å¸¸æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ExceptionHandler æ–¹æ³•</li>
<li>ä»¥ä¸Šä¸¤ç§ @ExceptionHandler çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li>
</ol>
<h3 id="_32-tomcat-å¼‚å¸¸å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_32-tomcat-å¼‚å¸¸å¤„ç†"><span>32) Tomcat å¼‚å¸¸å¤„ç†</span></a></h3>
<ul>
<li>
<p>æˆ‘ä»¬çŸ¥é“ @ExceptionHandler åªèƒ½å¤„ç†å‘ç”Ÿåœ¨ mvc æµç¨‹ä¸­çš„å¼‚å¸¸ï¼Œä¾‹å¦‚æ§åˆ¶å™¨å†…ã€æ‹¦æˆªå™¨å†…ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯ Filter å‡ºç°äº†å¼‚å¸¸ï¼Œå¦‚ä½•è¿›è¡Œå¤„ç†å‘¢ï¼Ÿ</p>
</li>
<li>
<p>åœ¨ Spring Boot ä¸­ï¼Œæ˜¯è¿™ä¹ˆå®ç°çš„ï¼š</p>
<ol>
<li>å› ä¸ºå†…åµŒäº† Tomcat å®¹å™¨ï¼Œå› æ­¤å¯ä»¥é…ç½® Tomcat çš„é”™è¯¯é¡µé¢ï¼ŒFilter ä¸ é”™è¯¯é¡µé¢ä¹‹é—´æ˜¯é€šè¿‡è¯·æ±‚è½¬å‘è·³è½¬çš„ï¼Œå¯ä»¥åœ¨è¿™é‡Œåšæ‰‹è„š</li>
<li>å…ˆé€šè¿‡ ErrorPageRegistrarBeanPostProcessor è¿™ä¸ªåå¤„ç†å™¨é…ç½®é”™è¯¯é¡µé¢åœ°å€ï¼Œé»˜è®¤ä¸º <code v-pre>/error</code> ä¹Ÿå¯ä»¥é€šè¿‡ <code v-pre>${server.error.path}</code> è¿›è¡Œé…ç½®</li>
<li>å½“ Filter å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¸ä¼šèµ° Spring æµç¨‹ï¼Œä½†ä¼šèµ° Tomcat çš„é”™è¯¯å¤„ç†ï¼Œäºæ˜¯å°±å¸Œæœ›è½¬å‘è‡³ <code v-pre>/error</code> è¿™ä¸ªåœ°å€
<ul>
<li>å½“ç„¶ï¼Œå¦‚æœæ²¡æœ‰ @ExceptionHandlerï¼Œé‚£ä¹ˆæœ€ç»ˆä¹Ÿä¼šèµ°åˆ° Tomcat çš„é”™è¯¯å¤„ç†</li>
</ul>
</li>
<li>Spring Boot åˆæä¾›äº†ä¸€ä¸ª BasicErrorControllerï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ ‡å‡† @Controllerï¼Œ@RequestMapping é…ç½®ä¸º <code v-pre>/error</code>ï¼Œæ‰€ä»¥å¤„ç†å¼‚å¸¸çš„èŒè´£å°±åˆå›åˆ°äº† Spring</li>
<li>å¼‚å¸¸ä¿¡æ¯ç”±äºä¼šè¢« Tomcat æ”¾å…¥ request ä½œç”¨åŸŸï¼Œå› æ­¤ BasicErrorController é‡Œä¹Ÿèƒ½è·å–åˆ°</li>
<li>å…·ä½“å¼‚å¸¸ä¿¡æ¯ä¼šç”± DefaultErrorAttributes å°è£…å¥½</li>
<li>BasicErrorController é€šè¿‡ Accept å¤´åˆ¤æ–­éœ€è¦ç”Ÿæˆå“ªç§ MediaType çš„å“åº”
<ul>
<li>å¦‚æœè¦çš„ä¸æ˜¯ text/htmlï¼Œèµ° MessageConverter æµç¨‹</li>
<li>å¦‚æœéœ€è¦ text/htmlï¼Œèµ° mvc æµç¨‹ï¼Œæ­¤æ—¶åˆåˆ†ä¸¤ç§æƒ…å†µ
<ul>
<li>é…ç½®äº† ErrorViewResolverï¼Œæ ¹æ®çŠ¶æ€ç å»æ‰¾ View</li>
<li>æ²¡é…ç½®æˆ–æ²¡æ‰¾åˆ°ï¼Œç”¨ BeanNameViewResolver æ ¹æ®ä¸€ä¸ªå›ºå®šä¸º error çš„åå­—æ‰¾åˆ° Viewï¼Œå³æ‰€è°“çš„ WhitelabelErrorView</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<blockquote>
<p><em><strong>è¯„ä»·</strong></em></p>
<ul>
<li>ä¸€ä¸ªé”™è¯¯å¤„ç†æå¾—è¿™ä¹ˆå¤æ‚ï¼Œå°±é—®æ¶å¿ƒä¸ï¼Ÿ</li>
</ul>
</blockquote>
<h4 id="æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†"><span>æ¼”ç¤º1 - é”™è¯¯é¡µå¤„ç†</span></a></h4>
<h5 id="å…³é”®ä»£ç -1" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -1"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸ä¿®æ”¹äº† Tomcat æœåŠ¡å™¨é»˜è®¤é”™è¯¯åœ°å€, å‡ºé”™æ—¶ä½¿ç”¨è¯·æ±‚è½¬å‘æ–¹å¼è·³è½¬</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ErrorPageRegistrar</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> errorPageRegistrar</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> webServerFactory </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> webServerFactory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addErrorPages</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ErrorPage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/error"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸TomcatServletWebServerFactory åˆå§‹åŒ–å‰ç”¨å®ƒå¢å¼º, æ³¨å†Œæ‰€æœ‰ ErrorPageRegistrar</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ErrorPageRegistrarBeanPostProcessor</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> errorPageRegistrarBeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ErrorPageRegistrarBeanPostProcessor</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-45" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-45"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Tomcat çš„é”™è¯¯é¡µå¤„ç†æ‰‹æ®µ</li>
</ol>
<h4 id="æ¼”ç¤º2-basicerrorcontroller" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-basicerrorcontroller"><span>æ¼”ç¤º2 - BasicErrorController</span></a></h4>
<h5 id="å…³é”®ä»£ç -2" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -2"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸ErrorProperties å°è£…ç¯å¢ƒé”®å€¼, ErrorAttributes æ§åˆ¶æœ‰å“ªäº›é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> BasicErrorController</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> basicErrorController</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    ErrorProperties</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> errorProperties </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ErrorProperties</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    errorProperties</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setIncludeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> BasicErrorController</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> DefaultErrorAttributes</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> errorProperties)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸åç§°ä¸º error çš„è§†å›¾, ä½œä¸º BasicErrorController çš„ text/html å“åº”ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> View</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> View</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Override</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> render</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            Map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">> </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            HttpServletRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            HttpServletResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> response</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        )</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Exception</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(model);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            response</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setContentType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"text/html;charset=utf-8"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            response</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"""</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                    &#x3C;h3>æœåŠ¡å™¨å†…éƒ¨é”™è¯¯&#x3C;/h3></span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">                    """</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">    }</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸æ”¶é›†å®¹å™¨ä¸­æ‰€æœ‰ View å¯¹è±¡, bean çš„åå­—ä½œä¸ºè§†å›¾å</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ViewResolver</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> viewResolver</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> BeanNameViewResolver</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-46" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-46"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>Spring Boot ä¸­ BasicErrorController å¦‚ä½•å·¥ä½œ</li>
</ol>
<h3 id="_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter" tabindex="-1"><a class="header-anchor" href="#_33-beannameurlhandlermapping-ä¸-simplecontrollerhandleradapter"><span>33) BeanNameUrlHandlerMapping ä¸ SimpleControllerHandlerAdapter</span></a></h3>
<h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><span>æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</span></a></h4>
<h5 id="å…³é”®ä»£ç -3" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -3"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> BeanNameUrlHandlerMapping</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> beanNameUrlHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> BeanNameUrlHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> SimpleControllerHandlerAdapter</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> simpleControllerHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> SimpleControllerHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/c3"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Controller</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> controller3</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> (request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> response) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        response</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getWriter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"this is c3"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">    }</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-47" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-47"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>BeanNameUrlHandlerMappingï¼Œä»¥ / å¼€å¤´çš„ bean çš„åå­—ä¼šè¢«å½“ä½œæ˜ å°„è·¯å¾„</li>
<li>è¿™äº› bean æœ¬èº«å½“ä½œ handlerï¼Œè¦æ±‚å®ç° Controller æ¥å£</li>
<li>SimpleControllerHandlerAdapterï¼Œè°ƒç”¨ handler</li>
<li>æ¨¡æ‹Ÿå®ç°è¿™ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</li>
</ol>
<h3 id="_34-routerfunctionmapping-ä¸-handlerfunctionadapter" tabindex="-1"><a class="header-anchor" href="#_34-routerfunctionmapping-ä¸-handlerfunctionadapter"><span>34) RouterFunctionMapping ä¸ HandlerFunctionAdapter</span></a></h3>
<h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-1" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-1"><span>æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</span></a></h4>
<h5 id="å…³é”®ä»£ç -4" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -4"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> RouterFunctionMapping</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> routerFunctionMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> RouterFunctionMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> HandlerFunctionAdapter</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> handlerFunctionAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> HandlerFunctionAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> RouterFunction</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&#x3C;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">ServerResponse</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">></span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> r1</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    //           â¬‡ï¸æ˜ å°„æ¡ä»¶   â¬‡ï¸handler</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> route</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">GET</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/r1"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> request </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">-></span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ok</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"this is r1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-48" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-48"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>RouterFunctionMapping, é€šè¿‡ RequestPredicate æ¡ä»¶æ˜ å°„</li>
<li>handler è¦å®ç° HandlerFunction æ¥å£</li>
<li>HandlerFunctionAdapter, è°ƒç”¨ handler</li>
</ol>
<h3 id="_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter" tabindex="-1"><a class="header-anchor" href="#_35-simpleurlhandlermapping-ä¸-httprequesthandleradapter"><span>35) SimpleUrlHandlerMapping ä¸ HttpRequestHandlerAdapter</span></a></h3>
<h4 id="æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><span>æ¼”ç¤º1 - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-39" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-39"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>org.springframework.boot.autoconfigure.web.servlet.A35</strong></p>
<h5 id="å…³é”®ä»£ç -5" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -5"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> SimpleUrlHandlerMapping</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> simpleUrlHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> context) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    SimpleUrlHandlerMapping</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> handlerMapping </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> SimpleUrlHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    Map</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&#x3C;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> ResourceHttpRequestHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">></span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> map </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">        =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getBeansOfType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">ResourceHttpRequestHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    handlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setUrlMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(map);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> handlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> HttpRequestHandlerAdapter</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> httpRequestHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> HttpRequestHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/**"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ResourceHttpRequestHandler</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> handler1</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    ResourceHttpRequestHandler</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> handler </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ResourceHttpRequestHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setLocations</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">List</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">of</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ClassPathResource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"static/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)));</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/img/**"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ResourceHttpRequestHandler</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> handler2</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    ResourceHttpRequestHandler</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> handler </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ResourceHttpRequestHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setLocations</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">List</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">of</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ClassPathResource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"images/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)));</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-49" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-49"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>SimpleUrlHandlerMapping ä¸ä¼šåœ¨åˆå§‹åŒ–æ—¶æ”¶é›†æ˜ å°„ä¿¡æ¯ï¼Œéœ€è¦æ‰‹åŠ¨æ”¶é›†</li>
<li>SimpleUrlHandlerMapping æ˜ å°„è·¯å¾„</li>
<li>ResourceHttpRequestHandler ä½œä¸ºé™æ€èµ„æº handler</li>
<li>HttpRequestHandlerAdapter, è°ƒç”¨æ­¤ handler</li>
</ol>
<h4 id="æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–"><span>æ¼”ç¤º2 - é™æ€èµ„æºè§£æä¼˜åŒ–</span></a></h4>
<h5 id="å…³é”®ä»£ç -6" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -6"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/**"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ResourceHttpRequestHandler</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> handler1</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    ResourceHttpRequestHandler</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> handler </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ResourceHttpRequestHandler</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setLocations</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">List</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">of</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ClassPathResource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"static/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setResourceResolvers</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">List</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">of</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        	// â¬‡ï¸ç¼“å­˜ä¼˜åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> CachingResourceResolver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ConcurrentMapCache</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"cache1"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)),</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        	// â¬‡ï¸å‹ç¼©ä¼˜åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> EncodedResourceResolver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(),</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        	// â¬‡ï¸åŸå§‹èµ„æºè§£æ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> PathResourceResolver</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    ));</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-50" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-50"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>è´£ä»»é“¾æ¨¡å¼ä½“ç°</li>
<li>å‹ç¼©æ–‡ä»¶éœ€è¦æ‰‹åŠ¨ç”Ÿæˆ</li>
</ol>
<h4 id="æ¼”ç¤º3-æ¬¢è¿é¡µ" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º3-æ¬¢è¿é¡µ"><span>æ¼”ç¤º3 - æ¬¢è¿é¡µ</span></a></h4>
<h5 id="å…³é”®ä»£ç -7" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -7"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> WelcomePageHandlerMapping</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> welcomePageHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> context) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    Resource</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> resource </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getResource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"classpath:static/index.html"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> WelcomePageHandlerMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/**"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> SimpleControllerHandlerAdapter</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> simpleControllerHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> SimpleControllerHandlerAdapter</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-51" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-51"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>æ¬¢è¿é¡µæ”¯æŒé™æ€æ¬¢è¿é¡µä¸åŠ¨æ€æ¬¢è¿é¡µ</li>
<li>WelcomePageHandlerMapping æ˜ å°„æ¬¢è¿é¡µï¼ˆå³åªæ˜ å°„ '/'ï¼‰
<ul>
<li>å®ƒå†…ç½®çš„ handler ParameterizableViewController ä½œç”¨æ˜¯ä¸æ‰§è¡Œé€»è¾‘ï¼Œä»…æ ¹æ®è§†å›¾åæ‰¾è§†å›¾</li>
<li>è§†å›¾åå›ºå®šä¸º forward:index.html</li>
</ul>
</li>
<li>SimpleControllerHandlerAdapter, è°ƒç”¨ handler
<ul>
<li>è½¬å‘è‡³ /index.html</li>
<li>å¤„ç† /index.html åˆä¼šèµ°ä¸Šé¢çš„é™æ€èµ„æºå¤„ç†æµç¨‹</li>
</ul>
</li>
</ol>
<h4 id="æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“" tabindex="-1"><a class="header-anchor" href="#æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“"><span>æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“</span></a></h4>
<ol>
<li>HandlerMapping è´Ÿè´£å»ºç«‹è¯·æ±‚ä¸æ§åˆ¶å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»
<ul>
<li>RequestMappingHandlerMapping (ä¸ @RequestMapping åŒ¹é…)</li>
<li>WelcomePageHandlerMapping    (/)</li>
<li>BeanNameUrlHandlerMapping    (ä¸ bean çš„åå­—åŒ¹é… ä»¥ / å¼€å¤´)</li>
<li>RouterFunctionMapping        (å‡½æ•°å¼ RequestPredicate, HandlerFunction)</li>
<li>SimpleUrlHandlerMapping      (é™æ€èµ„æº é€šé…ç¬¦ /** /img/**)</li>
<li>ä¹‹é—´ä¹Ÿä¼šæœ‰é¡ºåºé—®é¢˜, boot ä¸­é»˜è®¤é¡ºåºå¦‚ä¸Š</li>
</ul>
</li>
<li>HandlerAdapter è´Ÿè´£å®ç°å¯¹å„ç§å„æ ·çš„ handler çš„é€‚é…è°ƒç”¨
<ul>
<li>RequestMappingHandlerAdapter å¤„ç†ï¼š@RequestMapping æ–¹æ³•
<ul>
<li>å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ä½“ç°äº†ç»„åˆæ¨¡å¼</li>
</ul>
</li>
<li>SimpleControllerHandlerAdapter å¤„ç†ï¼šController æ¥å£</li>
<li>HandlerFunctionAdapter å¤„ç†ï¼šHandlerFunction å‡½æ•°å¼æ¥å£</li>
<li>HttpRequestHandlerAdapter å¤„ç†ï¼šHttpRequestHandler æ¥å£ (é™æ€èµ„æºå¤„ç†)</li>
<li>è¿™ä¹Ÿæ˜¯å…¸å‹é€‚é…å™¨æ¨¡å¼ä½“ç°</li>
</ul>
</li>
</ol>
<h3 id="_36-mvc-å¤„ç†æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_36-mvc-å¤„ç†æµç¨‹"><span>36) mvc å¤„ç†æµç¨‹</span></a></h3>
<p>å½“æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ <code v-pre>http://localhost:8080/hello</code> åï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œå…¶å¤„ç†æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>
<p>æœåŠ¡å™¨æä¾›äº† DispatcherServletï¼Œå®ƒä½¿ç”¨çš„æ˜¯æ ‡å‡† Servlet æŠ€æœ¯</p>
<ul>
<li>è·¯å¾„ï¼šé»˜è®¤æ˜ å°„è·¯å¾„ä¸º <code v-pre>/</code>ï¼Œå³ä¼šåŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ URLï¼Œå¯ä½œä¸ºè¯·æ±‚çš„ç»Ÿä¸€å…¥å£ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸º<strong>å‰æ§åˆ¶å™¨</strong>
<ul>
<li>jsp ä¸ä¼šåŒ¹é…åˆ° DispatcherServlet</li>
<li>å…¶å®ƒæœ‰è·¯å¾„çš„ Servlet åŒ¹é…ä¼˜å…ˆçº§ä¹Ÿé«˜äº DispatcherServlet</li>
</ul>
</li>
<li>åˆ›å»ºï¼šåœ¨ Boot ä¸­ï¼Œç”± DispatcherServletAutoConfiguration è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æä¾› DispatcherServlet çš„ bean</li>
<li>åˆå§‹åŒ–ï¼šDispatcherServlet åˆå§‹åŒ–æ—¶ä¼šä¼˜å…ˆåˆ°å®¹å™¨é‡Œå¯»æ‰¾å„ç§ç»„ä»¶ï¼Œä½œä¸ºå®ƒçš„æˆå‘˜å˜é‡
<ul>
<li>HandlerMappingï¼Œåˆå§‹åŒ–æ—¶è®°å½•æ˜ å°„å…³ç³»</li>
<li>HandlerAdapterï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li>
<li>HandlerExceptionResolverï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li>
<li>ViewResolver</li>
</ul>
</li>
</ul>
</li>
<li>
<p>DispatcherServlet ä¼šåˆ©ç”¨ RequestMappingHandlerMapping æŸ¥æ‰¾æ§åˆ¶å™¨æ–¹æ³•</p>
<ul>
<li>
<p>ä¾‹å¦‚æ ¹æ® /hello è·¯å¾„æ‰¾åˆ° @RequestMapping(&quot;/hello&quot;) å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•</p>
</li>
<li>
<p>æ§åˆ¶å™¨æ–¹æ³•ä¼šè¢«å°è£…ä¸º HandlerMethod å¯¹è±¡ï¼Œå¹¶ç»“åˆåŒ¹é…åˆ°çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet</p>
</li>
<li>
<p>HandlerMethod å’Œæ‹¦æˆªå™¨åˆåœ¨ä¸€èµ·ç§°ä¸º HandlerExecutionChainï¼ˆè°ƒç”¨é“¾ï¼‰å¯¹è±¡</p>
</li>
</ul>
</li>
<li>
<p>DispatcherServlet æ¥ä¸‹æ¥ä¼šï¼š</p>
<ol>
<li>è°ƒç”¨æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•</li>
<li>RequestMappingHandlerAdapter è°ƒç”¨ handle æ–¹æ³•ï¼Œå‡†å¤‡æ•°æ®ç»‘å®šå·¥å‚ã€æ¨¡å‹å·¥å‚ã€ModelAndViewContainerã€å°† HandlerMethod å®Œå–„ä¸º ServletInvocableHandlerMethod
<ul>
<li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹1ï¸âƒ£ï¼šè¡¥å……æ¨¡å‹æ•°æ®</li>
<li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹2ï¸âƒ£ï¼šè¡¥å……è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨</li>
<li>ä½¿ç”¨ HandlerMethodArgumentResolver å‡†å¤‡å‚æ•°
<ul>
<li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹3ï¸âƒ£ï¼šRequestBody å¢å¼º</li>
</ul>
</li>
<li>è°ƒç”¨ ServletInvocableHandlerMethod</li>
<li>ä½¿ç”¨ HandlerMethodReturnValueHandler å¤„ç†è¿”å›å€¼
<ul>
<li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹4ï¸âƒ£ï¼šResponseBody å¢å¼º</li>
</ul>
</li>
<li>æ ¹æ® ModelAndViewContainer è·å– ModelAndView
<ul>
<li>å¦‚æœè¿”å›çš„ ModelAndView ä¸º nullï¼Œä¸èµ°ç¬¬ 4 æ­¥è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹
<ul>
<li>ä¾‹å¦‚ï¼Œæœ‰çš„è¿”å›å€¼å¤„ç†å™¨è°ƒç”¨äº† HttpMessageConverter æ¥å°†ç»“æœè½¬æ¢ä¸º JSONï¼Œè¿™æ—¶ ModelAndView å°±ä¸º null</li>
</ul>
</li>
<li>å¦‚æœè¿”å›çš„ ModelAndView ä¸ä¸º nullï¼Œä¼šåœ¨ç¬¬ 4 æ­¥èµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li>
</ul>
</li>
</ul>
</li>
<li>è°ƒç”¨æ‹¦æˆªå™¨çš„ postHandle æ–¹æ³•</li>
<li>å¤„ç†å¼‚å¸¸æˆ–è§†å›¾æ¸²æŸ“
<ul>
<li>å¦‚æœ 1~3 å‡ºç°å¼‚å¸¸ï¼Œèµ° ExceptionHandlerExceptionResolver å¤„ç†å¼‚å¸¸æµç¨‹
<ul>
<li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹5ï¸âƒ£ï¼š@ExceptionHandler å¼‚å¸¸å¤„ç†</li>
</ul>
</li>
<li>æ­£å¸¸ï¼Œèµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li>
</ul>
</li>
<li>è°ƒç”¨æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•</li>
</ol>
</li>
</ol>
<h2 id="boot" tabindex="-1"><a class="header-anchor" href="#boot"><span>Boot</span></a></h2>
<h3 id="_37-boot-éª¨æ¶é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_37-boot-éª¨æ¶é¡¹ç›®"><span>37) Boot éª¨æ¶é¡¹ç›®</span></a></h3>
<p>å¦‚æœæ˜¯ linux ç¯å¢ƒï¼Œç”¨ä»¥ä¸‹å‘½ä»¤å³å¯è·å– spring boot çš„éª¨æ¶ pom.xml</p>
<div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://start.spring.io/pom.xml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dependencies=web,mysql,mybatis</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> pom.xml</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Postman ç­‰å·¥å…·å®ç°</p>
<p>è‹¥æƒ³è·å–æ›´å¤šç”¨æ³•ï¼Œè¯·å‚è€ƒ</p>
<div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">curl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://start.spring.io</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3 id="_38-boot-waré¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_38-boot-waré¡¹ç›®"><span>38) Boot Waré¡¹ç›®</span></a></h3>
<p>æ­¥éª¤1ï¼šåˆ›å»ºæ¨¡å—ï¼ŒåŒºåˆ«åœ¨äºæ‰“åŒ…æ–¹å¼é€‰æ‹© war</p>
<img src="img/image-20211021160145072.png" alt="image-20211021160145072" style="zoom: 50%;" />
<p>æ¥ä¸‹æ¥å‹¾é€‰ Spring Web æ”¯æŒ</p>
<img src="img/image-20211021162416525.png" alt="image-20211021162416525" style="zoom:50%;" />
<p>æ­¥éª¤2ï¼šç¼–å†™æ§åˆ¶å™¨</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Controller</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyController</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">RequestMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/hello"</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> String</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> abc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"è¿›å…¥äº†æ§åˆ¶å™¨"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "hello"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¥éª¤3ï¼šç¼–å†™ jsp è§†å›¾ï¼Œæ–°å»º webapp ç›®å½•å’Œä¸€ä¸ª hello.jsp æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åä¸æ§åˆ¶å™¨æ–¹æ³•è¿”å›çš„è§†å›¾é€»è¾‘åä¸€è‡´</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>src</span></span>
<span class="line"><span>	|- main</span></span>
<span class="line"><span>		|- java</span></span>
<span class="line"><span>		|- resources</span></span>
<span class="line"><span>		|- webapp</span></span>
<span class="line"><span>			|- hello.jsp</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¥éª¤4ï¼šé…ç½®è§†å›¾è·¯å¾„ï¼Œæ‰“å¼€ application.properties æ–‡ä»¶</p>
<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">spring.mvc.view.prefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">/</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">spring.mvc.view.suffix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">.jsp</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>å°†æ¥ prefix + æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼ + suffix å³ä¸ºè§†å›¾å®Œæ•´è·¯å¾„</p>
</blockquote>
<h4 id="æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•"><span>æµ‹è¯•</span></a></h4>
<p>å¦‚æœç”¨ mvn æ’ä»¶ <code v-pre>mvn spring-boot:run</code> æˆ– main æ–¹æ³•æµ‹è¯•</p>
<ul>
<li>å¿…é¡»æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼Œå› ä¸ºæ­¤æ—¶ç”¨çš„è¿˜æ˜¯å†…åµŒ tomcatï¼Œè€Œå†…åµŒ tomcat é»˜è®¤ä¸å¸¦ jasperï¼ˆç”¨æ¥è§£æ jspï¼‰</li>
</ul>
<div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>org.apache.tomcat.embed&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>tomcat-embed-jasper&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>provided&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Idea é…ç½® tomcat æ¥æµ‹è¯•ï¼Œæ­¤æ—¶ç”¨çš„æ˜¯å¤–ç½® tomcat</p>
<ul>
<li>éª¨æ¶ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œå¤šäº†ä¸€ä¸ª ServletInitializerï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯é…ç½®å¤–ç½® Tomcat ä½¿ç”¨çš„ï¼Œåœ¨å¤–ç½® Tomcat å¯åŠ¨åï¼Œå»è°ƒç”¨å®ƒåˆ›å»ºå’Œè¿è¡Œ SpringApplication</li>
</ul>
<h4 id="å¯ç¤º" tabindex="-1"><a class="header-anchor" href="#å¯ç¤º"><span>å¯ç¤º</span></a></h4>
<p>å¯¹äº jar é¡¹ç›®ï¼Œè‹¥è¦æ”¯æŒ jspï¼Œä¹Ÿå¯ä»¥åœ¨åŠ å…¥ jasper ä¾èµ–çš„å‰æä¸‹ï¼ŒæŠŠ jsp æ–‡ä»¶ç½®å…¥ <code v-pre>META-INF/resources</code></p>
<h3 id="_39-boot-å¯åŠ¨è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#_39-boot-å¯åŠ¨è¿‡ç¨‹"><span>39) Boot å¯åŠ¨è¿‡ç¨‹</span></a></h3>
<p>é˜¶æ®µä¸€ï¼šSpringApplication æ„é€ </p>
<ol>
<li>è®°å½• BeanDefinition æº</li>
<li>æ¨æ–­åº”ç”¨ç±»å‹</li>
<li>è®°å½• ApplicationContext åˆå§‹åŒ–å™¨</li>
<li>è®°å½•ç›‘å¬å™¨</li>
<li>æ¨æ–­ä¸»å¯åŠ¨ç±»</li>
</ol>
<p>é˜¶æ®µäºŒï¼šæ‰§è¡Œ run æ–¹æ³•</p>
<ol>
<li>
<p>å¾—åˆ° SpringApplicationRunListenersï¼Œåå­—å–å¾—ä¸å¥½ï¼Œå®é™…æ˜¯äº‹ä»¶å‘å¸ƒå™¨</p>
<ul>
<li>å‘å¸ƒ application starting äº‹ä»¶1ï¸âƒ£</li>
</ul>
</li>
<li>
<p>å°è£…å¯åŠ¨ args</p>
</li>
<li>
<p>å‡†å¤‡ Environment æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ï¼ˆ*ï¼‰</p>
</li>
<li>
<p>ConfigurationPropertySources å¤„ç†ï¼ˆ*ï¼‰</p>
<ul>
<li>å‘å¸ƒ application environment å·²å‡†å¤‡äº‹ä»¶2ï¸âƒ£</li>
</ul>
</li>
<li>
<p>é€šè¿‡ EnvironmentPostProcessorApplicationListener è¿›è¡Œ env åå¤„ç†ï¼ˆ*ï¼‰</p>
<ul>
<li>application.propertiesï¼Œç”± StandardConfigDataLocationResolver è§£æ</li>
<li>spring.application.json</li>
</ul>
</li>
<li>
<p>ç»‘å®š spring.main åˆ° SpringApplication å¯¹è±¡ï¼ˆ*ï¼‰</p>
</li>
<li>
<p>æ‰“å° bannerï¼ˆ*ï¼‰</p>
</li>
<li>
<p>åˆ›å»ºå®¹å™¨</p>
</li>
<li>
<p>å‡†å¤‡å®¹å™¨</p>
<ul>
<li>å‘å¸ƒ application context å·²åˆå§‹åŒ–äº‹ä»¶3ï¸âƒ£</li>
</ul>
</li>
<li>
<p>åŠ è½½ bean å®šä¹‰</p>
<ul>
<li>å‘å¸ƒ application prepared äº‹ä»¶4ï¸âƒ£</li>
</ul>
</li>
<li>
<p>refresh å®¹å™¨</p>
<ul>
<li>å‘å¸ƒ application started äº‹ä»¶5ï¸âƒ£</li>
</ul>
</li>
<li>
<p>æ‰§è¡Œ runner</p>
<ul>
<li>
<p>å‘å¸ƒ application ready äº‹ä»¶6ï¸âƒ£</p>
</li>
<li>
<p>è¿™å…¶ä¸­æœ‰å¼‚å¸¸ï¼Œå‘å¸ƒ application failed äº‹ä»¶7ï¸âƒ£</p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p>å¸¦ * çš„æœ‰ç‹¬ç«‹çš„ç¤ºä¾‹</p>
</blockquote>
<h4 id="æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹"><span>æ¼”ç¤º - å¯åŠ¨è¿‡ç¨‹</span></a></h4>
<p><strong>com.itheima.a39.A39_1</strong> å¯¹åº” SpringApplication æ„é€ </p>
<p><strong>com.itheima.a39.A39_2</strong> å¯¹åº”ç¬¬1æ­¥ï¼Œå¹¶æ¼”ç¤º 7 ä¸ªäº‹ä»¶</p>
<p><strong>com.itheima.a39.A39_3</strong> å¯¹åº”ç¬¬2ã€8åˆ°12æ­¥</p>
<p><strong>org.springframework.boot.Step3</strong></p>
<p><strong>org.springframework.boot.Step4</strong></p>
<p><strong>org.springframework.boot.Step5</strong></p>
<p><strong>org.springframework.boot.Step6</strong></p>
<p><strong>org.springframework.boot.Step7</strong></p>
<h4 id="æ”¶è·ğŸ’¡-52" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-52"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>SpringApplication æ„é€ æ–¹æ³•ä¸­æ‰€åšçš„æ“ä½œ
<ul>
<li>å¯ä»¥æœ‰å¤šç§æºç”¨æ¥åŠ è½½ bean å®šä¹‰</li>
<li>åº”ç”¨ç±»å‹æ¨æ–­</li>
<li>æ·»åŠ å®¹å™¨åˆå§‹åŒ–å™¨</li>
<li>æ·»åŠ ç›‘å¬å™¨</li>
<li>æ¼”ç¤ºä¸»ç±»æ¨æ–­</li>
</ul>
</li>
<li>å¦‚ä½•è¯»å– spring.factories ä¸­çš„é…ç½®</li>
<li>ä»é…ç½®ä¸­è·å–é‡è¦çš„äº‹ä»¶å‘å¸ƒå™¨ï¼šSpringApplicationRunListeners</li>
<li>å®¹å™¨çš„åˆ›å»ºã€åˆå§‹åŒ–å™¨å¢å¼ºã€åŠ è½½ bean å®šä¹‰ç­‰</li>
<li>CommandLineRunnerã€ApplicationRunner çš„ä½œç”¨</li>
<li>ç¯å¢ƒå¯¹è±¡
<ol>
<li>å‘½ä»¤è¡Œ PropertySource</li>
<li>ConfigurationPropertySources è§„èŒƒç¯å¢ƒé”®åç§°</li>
<li>EnvironmentPostProcessor åå¤„ç†å¢å¼º
<ul>
<li>ç”± EventPublishingRunListener é€šè¿‡ç›‘å¬äº‹ä»¶2ï¸âƒ£æ¥è°ƒç”¨</li>
</ul>
</li>
<li>ç»‘å®š spring.main å‰ç¼€çš„ key value è‡³ SpringApplication</li>
</ol>
</li>
<li>Banner</li>
</ol>
<h3 id="_40-tomcat-å†…åµŒå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_40-tomcat-å†…åµŒå®¹å™¨"><span>40) Tomcat å†…åµŒå®¹å™¨</span></a></h3>
<p>Tomcat åŸºæœ¬ç»“æ„</p>
<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Server</span></span>
<span class="line"><span>â””â”€â”€â”€Service</span></span>
<span class="line"><span>    â”œâ”€â”€â”€Connector (åè®®, ç«¯å£)</span></span>
<span class="line"><span>    â””â”€â”€â”€Engine</span></span>
<span class="line"><span>        â””â”€â”€â”€Host(è™šæ‹Ÿä¸»æœº localhost)</span></span>
<span class="line"><span>            â”œâ”€â”€â”€Context1 (åº”ç”¨1, å¯ä»¥è®¾ç½®è™šæ‹Ÿè·¯å¾„, / å³ url èµ·å§‹è·¯å¾„; é¡¹ç›®ç£ç›˜è·¯å¾„, å³ docBase )</span></span>
<span class="line"><span>            â”‚   â”‚   index.html</span></span>
<span class="line"><span>            â”‚   â””â”€â”€â”€WEB-INF</span></span>
<span class="line"><span>            â”‚       â”‚   web.xml (servlet, filter, listener) 3.0</span></span>
<span class="line"><span>            â”‚       â”œâ”€â”€â”€classes (servlet, controller, service ...)</span></span>
<span class="line"><span>            â”‚       â”œâ”€â”€â”€jsp</span></span>
<span class="line"><span>            â”‚       â””â”€â”€â”€lib (ç¬¬ä¸‰æ–¹ jar åŒ…)</span></span>
<span class="line"><span>            â””â”€â”€â”€Context2 (åº”ç”¨2)</span></span>
<span class="line"><span>                â”‚   index.html</span></span>
<span class="line"><span>                â””â”€â”€â”€WEB-INF</span></span>
<span class="line"><span>                        web.xml</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º1-tomcat-å†…åµŒå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º1-tomcat-å†…åµŒå®¹å™¨"><span>æ¼”ç¤º1 - Tomcat å†…åµŒå®¹å™¨</span></a></h4>
<h5 id="å…³é”®ä»£ç -8" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -8"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">[] args) throws LifecycleException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> IOException {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 1.åˆ›å»º Tomcat å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    Tomcat</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> tomcat </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setBaseDir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"tomcat"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 2.åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹, å³ docBase æ–‡ä»¶å¤¹</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> docBase </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> Files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">createTempDirectory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"boot."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">toFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    docBase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">deleteOnExit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 3.åˆ›å»º Tomcat é¡¹ç›®, åœ¨ Tomcat ä¸­ç§°ä¸º Context</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    Context</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> context </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addContext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">docBase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getAbsolutePath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 4.ç¼–ç¨‹æ·»åŠ  Servlet</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addServletContainerInitializer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ServletContainerInitializer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Override</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> onStartup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>> </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ServletContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> ctx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ServletException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            HelloServlet</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> helloServlet</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> HelloServlet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            ctx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addServlet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"aaa"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, helloServlet).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/hello"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Collections</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">emptySet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 5.å¯åŠ¨ Tomcat</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // 6.åˆ›å»ºè¿æ¥å™¨, è®¾ç½®ç›‘å¬ç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">    Connector</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> connector </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Connector</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Http11Nio2Protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">())</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    connector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">8080</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">    tomcat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">setConnector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(connector);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º2-é›†æˆ-spring-å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º2-é›†æˆ-spring-å®¹å™¨"><span>æ¼”ç¤º2 - é›†æˆ Spring å®¹å™¨</span></a></h4>
<h5 id="å…³é”®ä»£ç -9" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -9"><span>å…³é”®ä»£ç </span></a></h5>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">WebApplicationContext</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> springContext </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> getApplicationContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">// 4.ç¼–ç¨‹æ·»åŠ  Servlet</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">addServletContainerInitializer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ServletContainerInitializer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Override</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> onStartup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">Class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>> </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ServletContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> ctx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> ServletException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">        // â¬‡ï¸é€šè¿‡ ServletRegistrationBean æ·»åŠ  DispatcherServlet ç­‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ServletRegistrationBean</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> registrationBean</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">             springContext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getBeansOfType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">ServletRegistrationBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">values</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            registrationBean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">onStartup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ctx);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">Collections</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">emptySet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_41-boot-è‡ªåŠ¨é…ç½®" tabindex="-1"><a class="header-anchor" href="#_41-boot-è‡ªåŠ¨é…ç½®"><span>41) Boot è‡ªåŠ¨é…ç½®</span></a></h3>
<h4 id="aopautoconfiguration" tabindex="-1"><a class="header-anchor" href="#aopautoconfiguration"><span>AopAutoConfiguration</span></a></h4>
<p>Spring Boot æ˜¯åˆ©ç”¨äº†è‡ªåŠ¨é…ç½®ç±»æ¥ç®€åŒ–äº† aop ç›¸å…³é…ç½®</p>
<ul>
<li>AOP è‡ªåŠ¨é…ç½®ç±»ä¸º <code v-pre>org.springframework.boot.autoconfigure.aop.AopAutoConfiguration</code></li>
<li>å¯ä»¥é€šè¿‡ <code v-pre>spring.aop.auto=false</code> ç¦ç”¨ aop è‡ªåŠ¨é…ç½®</li>
<li>AOP è‡ªåŠ¨é…ç½®çš„æœ¬è´¨æ˜¯é€šè¿‡ <code v-pre>@EnableAspectJAutoProxy</code> æ¥å¼€å¯äº†è‡ªåŠ¨ä»£ç†ï¼Œå¦‚æœåœ¨å¼•å¯¼ç±»ä¸Šè‡ªå·±æ·»åŠ äº† <code v-pre>@EnableAspectJAutoProxy</code> é‚£ä¹ˆä»¥è‡ªå·±æ·»åŠ çš„ä¸ºå‡†</li>
<li><code v-pre>@EnableAspectJAutoProxy</code> çš„æœ¬è´¨æ˜¯å‘å®¹å™¨ä¸­æ·»åŠ äº† <code v-pre>AnnotationAwareAspectJAutoProxyCreator</code> è¿™ä¸ª bean åå¤„ç†å™¨ï¼Œå®ƒèƒ½å¤Ÿæ‰¾åˆ°å®¹å™¨ä¸­æ‰€æœ‰åˆ‡é¢ï¼Œå¹¶ä¸ºåŒ¹é…åˆ‡ç‚¹çš„ç›®æ ‡ç±»åˆ›å»ºä»£ç†ï¼Œåˆ›å»ºä»£ç†çš„å·¥ä½œä¸€èˆ¬æ˜¯åœ¨ bean çš„åˆå§‹åŒ–é˜¶æ®µå®Œæˆçš„</li>
</ul>
<h4 id="datasourceautoconfiguration" tabindex="-1"><a class="header-anchor" href="#datasourceautoconfiguration"><span>DataSourceAutoConfiguration</span></a></h4>
<ul>
<li>å¯¹åº”çš„è‡ªåŠ¨é…ç½®ç±»ä¸ºï¼šorg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</li>
<li>å®ƒå†…éƒ¨é‡‡ç”¨äº†æ¡ä»¶è£…é…ï¼Œé€šè¿‡æ£€æŸ¥å®¹å™¨çš„ beanï¼Œä»¥åŠç±»è·¯å¾„ä¸‹çš„ classï¼Œæ¥å†³å®šè¯¥ @Bean æ˜¯å¦ç”Ÿæ•ˆ</li>
</ul>
<p>ç®€å•è¯´æ˜ä¸€ä¸‹ï¼ŒSpring Boot æ”¯æŒä¸¤å¤§ç±»æ•°æ®æºï¼š</p>
<ul>
<li>EmbeddedDatabase - å†…åµŒæ•°æ®åº“è¿æ¥æ± </li>
<li>PooledDataSource - éå†…åµŒæ•°æ®åº“è¿æ¥æ± </li>
</ul>
<p>PooledDataSource åˆæ”¯æŒå¦‚ä¸‹æ•°æ®æº</p>
<ul>
<li>hikari æä¾›çš„ HikariDataSource</li>
<li>tomcat-jdbc æä¾›çš„ DataSource</li>
<li>dbcp2 æä¾›çš„ BasicDataSource</li>
<li>oracle æä¾›çš„ PoolDataSourceImpl</li>
</ul>
<p>å¦‚æœçŸ¥é“æ•°æ®æºçš„å®ç°ç±»ç±»å‹ï¼Œå³æŒ‡å®šäº† <code v-pre>spring.datasource.type</code>ï¼Œç†è®ºä¸Šå¯ä»¥æ”¯æŒæ‰€æœ‰æ•°æ®æºï¼Œä½†è¿™æ ·åšçš„ä¸€ä¸ªæœ€å¤§é—®é¢˜æ˜¯æ— æ³•è®¢åˆ¶æ¯ç§æ•°æ®æºçš„è¯¦ç»†é…ç½®ï¼ˆå¦‚æœ€å¤§ã€æœ€å°è¿æ¥æ•°ç­‰ï¼‰</p>
<h4 id="mybatisautoconfiguration" tabindex="-1"><a class="header-anchor" href="#mybatisautoconfiguration"><span>MybatisAutoConfiguration</span></a></h4>
<ul>
<li>MyBatis è‡ªåŠ¨é…ç½®ç±»ä¸º <code v-pre>org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</code></li>
<li>å®ƒä¸»è¦é…ç½®äº†ä¸¤ä¸ª bean
<ul>
<li>SqlSessionFactory - MyBatis æ ¸å¿ƒå¯¹è±¡ï¼Œç”¨æ¥åˆ›å»º SqlSession</li>
<li>SqlSessionTemplate - SqlSession çš„å®ç°ï¼Œæ­¤å®ç°ä¼šä¸å½“å‰çº¿ç¨‹ç»‘å®š</li>
<li>ç”¨ ImportBeanDefinitionRegistrar çš„æ–¹å¼æ‰«ææ‰€æœ‰æ ‡æ³¨äº† @Mapper æ³¨è§£çš„æ¥å£</li>
<li>ç”¨ AutoConfigurationPackages æ¥ç¡®å®šæ‰«æçš„åŒ…</li>
</ul>
</li>
<li>è¿˜æœ‰ä¸€ä¸ªç›¸å…³çš„ beanï¼šMybatisPropertiesï¼Œå®ƒä¼šè¯»å–é…ç½®æ–‡ä»¶ä¸­å¸¦ <code v-pre>mybatis.</code> å‰ç¼€çš„é…ç½®é¡¹è¿›è¡Œå®šåˆ¶é…ç½®</li>
</ul>
<p>@MapperScan æ³¨è§£çš„ä½œç”¨ä¸ MybatisAutoConfiguration ç±»ä¼¼ï¼Œä¼šæ³¨å†Œ MapperScannerConfigurer æœ‰å¦‚ä¸‹åŒºåˆ«</p>
<ul>
<li>@MapperScan æ‰«æå…·ä½“åŒ…ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é…ç½®å…³æ³¨å“ªä¸ªæ³¨è§£ï¼‰</li>
<li>@MapperScan å¦‚æœä¸æŒ‡å®šæ‰«æå…·ä½“åŒ…ï¼Œåˆ™ä¼šæŠŠå¼•å¯¼ç±»èŒƒå›´å†…ï¼Œæ‰€æœ‰æ¥å£å½“åš Mapper æ¥å£</li>
<li>MybatisAutoConfiguration å…³æ³¨çš„æ˜¯æ‰€æœ‰æ ‡æ³¨ @Mapper æ³¨è§£çš„æ¥å£ï¼Œä¼šå¿½ç•¥æ‰é @Mapper æ ‡æ³¨çš„æ¥å£</li>
</ul>
<p>è¿™é‡Œæœ‰åŒå­¦æœ‰ç–‘é—®ï¼Œä¹‹å‰ä»‹ç»çš„éƒ½æ˜¯å°†å…·ä½“ç±»äº¤ç»™ Spring ç®¡ç†ï¼Œæ€ä¹ˆåˆ°äº† MyBatis è¿™å„¿ï¼Œæ¥å£å°±å¯ä»¥è¢«ç®¡ç†å‘¢ï¼Ÿ</p>
<ul>
<li>å…¶å®å¹¶éå°†æ¥å£äº¤ç»™ Spring ç®¡ç†ï¼Œè€Œæ˜¯æ¯ä¸ªæ¥å£ä¼šå¯¹åº”ä¸€ä¸ª MapperFactoryBeanï¼Œæ˜¯åè€…è¢« Spring æ‰€ç®¡ç†ï¼Œæ¥å£åªæ˜¯ä½œä¸º MapperFactoryBean çš„ä¸€ä¸ªå±æ€§æ¥é…ç½®</li>
</ul>
<h4 id="transactionautoconfiguration" tabindex="-1"><a class="header-anchor" href="#transactionautoconfiguration"><span>TransactionAutoConfiguration</span></a></h4>
<ul>
<li>
<p>äº‹åŠ¡è‡ªåŠ¨é…ç½®ç±»æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li><code v-pre>org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration</code></li>
<li><code v-pre>org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration</code></li>
</ul>
</li>
<li>
<p>å‰è€…é…ç½®äº† DataSourceTransactionManager ç”¨æ¥æ‰§è¡Œäº‹åŠ¡çš„æäº¤ã€å›æ»šæ“ä½œ</p>
</li>
<li>
<p>åè€…åŠŸèƒ½ä¸Šå¯¹æ ‡ @EnableTransactionManagementï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ª bean</p>
<ul>
<li>BeanFactoryTransactionAttributeSourceAdvisor äº‹åŠ¡åˆ‡é¢ç±»ï¼ŒåŒ…å«é€šçŸ¥å’Œåˆ‡ç‚¹</li>
<li>TransactionInterceptor äº‹åŠ¡é€šçŸ¥ç±»ï¼Œç”±å®ƒåœ¨ç›®æ ‡æ–¹æ³•è°ƒç”¨å‰ååŠ å…¥äº‹åŠ¡æ“ä½œ</li>
<li>AnnotationTransactionAttributeSource ä¼šè§£æ @Transactional åŠäº‹åŠ¡å±æ€§ï¼Œä¹ŸåŒ…å«äº†åˆ‡ç‚¹åŠŸèƒ½</li>
</ul>
</li>
<li>
<p>å¦‚æœè‡ªå·±é…ç½®äº† DataSourceTransactionManager æˆ–æ˜¯åœ¨å¼•å¯¼ç±»åŠ äº† @EnableTransactionManagementï¼Œåˆ™ä»¥è‡ªå·±é…ç½®çš„ä¸ºå‡†</p>
</li>
</ul>
<h4 id="servletwebserverfactoryautoconfiguration" tabindex="-1"><a class="header-anchor" href="#servletwebserverfactoryautoconfiguration"><span>ServletWebServerFactoryAutoConfiguration</span></a></h4>
<ul>
<li>æä¾› ServletWebServerFactory</li>
</ul>
<h4 id="dispatcherservletautoconfiguration" tabindex="-1"><a class="header-anchor" href="#dispatcherservletautoconfiguration"><span>DispatcherServletAutoConfiguration</span></a></h4>
<ul>
<li>æä¾› DispatcherServlet</li>
<li>æä¾› DispatcherServletRegistrationBean</li>
</ul>
<h4 id="webmvcautoconfiguration" tabindex="-1"><a class="header-anchor" href="#webmvcautoconfiguration"><span>WebMvcAutoConfiguration</span></a></h4>
<ul>
<li>é…ç½® DispatcherServlet çš„å„é¡¹ç»„ä»¶ï¼Œæä¾›çš„ bean è§è¿‡çš„æœ‰
<ul>
<li>å¤šé¡¹ HandlerMapping</li>
<li>å¤šé¡¹ HandlerAdapter</li>
<li>HandlerExceptionResolver</li>
</ul>
</li>
</ul>
<h4 id="errormvcautoconfiguration" tabindex="-1"><a class="header-anchor" href="#errormvcautoconfiguration"><span>ErrorMvcAutoConfiguration</span></a></h4>
<ul>
<li>æä¾›çš„ bean æœ‰ BasicErrorController</li>
</ul>
<h4 id="multipartautoconfiguration" tabindex="-1"><a class="header-anchor" href="#multipartautoconfiguration"><span>MultipartAutoConfiguration</span></a></h4>
<ul>
<li>å®ƒæä¾›äº† org.springframework.web.multipart.support.StandardServletMultipartResolver</li>
<li>è¯¥ bean ç”¨æ¥è§£æ multipart/form-data æ ¼å¼çš„æ•°æ®</li>
</ul>
<h4 id="httpencodingautoconfiguration" tabindex="-1"><a class="header-anchor" href="#httpencodingautoconfiguration"><span>HttpEncodingAutoConfiguration</span></a></h4>
<ul>
<li>POST è¯·æ±‚å‚æ•°å¦‚æœæœ‰ä¸­æ–‡ï¼Œæ— éœ€ç‰¹æ®Šè®¾ç½®ï¼Œè¿™æ˜¯å› ä¸º Spring Boot å·²ç»é…ç½®äº† org.springframework.boot.web.servlet.filter.OrderedCharacterEncodingFilter</li>
<li>å¯¹åº”é…ç½® server.servlet.encoding.charset=UTF-8ï¼Œé»˜è®¤å°±æ˜¯ UTF-8</li>
<li>å½“ç„¶ï¼Œå®ƒåªå½±å“é json æ ¼å¼çš„æ•°æ®</li>
</ul>
<h4 id="æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†"><span>æ¼”ç¤º - è‡ªåŠ¨é…ç½®ç±»åŸç†</span></a></h4>
<h5 id="å…³é”®ä»£ç -10" tabindex="-1"><a class="header-anchor" href="#å…³é”®ä»£ç -10"><span>å…³é”®ä»£ç </span></a></h5>
<p>å‡è®¾å·²æœ‰ç¬¬ä¸‰æ–¹çš„ä¸¤ä¸ªè‡ªåŠ¨é…ç½®ç±»</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Configuration</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> AutoConfiguration1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Bean1</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bean1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Bean1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Configuration</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> AutoConfiguration2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Bean2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bean2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Bean2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶ META-INF/spring.factoriesï¼Œkey ä¸ºå¯¼å…¥å™¨ç±»åï¼Œå€¼ä¸ºå¤šä¸ªè‡ªåŠ¨é…ç½®ç±»åï¼Œç”¨é€—å·åˆ†éš”</p>
<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD">MyImportSelector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379">\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379">AutoConfiguration1,\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379">AutoConfiguration2</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><em><strong>æ³¨æ„</strong></em></p>
<ul>
<li>ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­ MyImportSelector ä¸ AutoConfiguration1ï¼ŒAutoConfiguration2 ä¸ºç®€æ´å‡çœç•¥äº†åŒ…åï¼Œè‡ªå·±æµ‹è¯•æ—¶è¯·å°†åŒ…åæ ¹æ®æƒ…å†µè¡¥å…¨</li>
</ul>
</blockquote>
<p>å¼•å…¥è‡ªåŠ¨é…ç½®</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Configuration</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // â¬…ï¸æœ¬é¡¹ç›®çš„é…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Import</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MyImportSelector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyImportSelector</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> DeferredImportSelector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // â¬‡ï¸è¯¥æ–¹æ³•ä» META-INF/spring.factories è¯»å–è‡ªåŠ¨é…ç½®ç±»åï¼Œè¿”å›çš„ String[] å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">[] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">selectImports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">AnnotationMetadata</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> importingClassMetadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> SpringFactoriesLoader</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">loadFactoryNames</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MyImportSelector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">toArray</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-53" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-53"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>è‡ªåŠ¨é…ç½®ç±»æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé…ç½®ç±»è€Œå·²ï¼Œåªæ˜¯ç”¨ META-INF/spring.factories ç®¡ç†ï¼Œä¸åº”ç”¨é…ç½®ç±»è§£è€¦</li>
<li>@Enable æ‰“å¤´çš„æ³¨è§£æœ¬è´¨æ˜¯åˆ©ç”¨äº† @Import</li>
<li>@Import é…åˆ DeferredImportSelector å³å¯å®ç°å¯¼å…¥ï¼ŒselectImports æ–¹æ³•çš„è¿”å›å€¼å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»å</li>
<li>DeferredImportSelector çš„å¯¼å…¥ä¼šåœ¨æœ€åæ‰§è¡Œï¼Œä¸ºçš„æ˜¯è®©å…¶å®ƒé…ç½®ä¼˜å…ˆè§£æ</li>
</ol>
<h3 id="_42-æ¡ä»¶è£…é…åº•å±‚" tabindex="-1"><a class="header-anchor" href="#_42-æ¡ä»¶è£…é…åº•å±‚"><span>42) æ¡ä»¶è£…é…åº•å±‚</span></a></h3>
<p>æ¡ä»¶è£…é…çš„åº•å±‚æ˜¯æœ¬è´¨ä¸Šæ˜¯ @Conditional ä¸ Conditionï¼Œè¿™ä¸¤ä¸ªæ³¨è§£ã€‚å¼•å…¥è‡ªåŠ¨é…ç½®ç±»æ—¶ï¼ŒæœŸæœ›æ»¡è¶³ä¸€å®šæ¡ä»¶æ‰èƒ½è¢« Spring ç®¡ç†ï¼Œä¸æ»¡è¶³åˆ™ä¸ç®¡ç†ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚æ¡ä»¶æ˜¯ã€ç±»è·¯å¾„ä¸‹å¿…é¡»æœ‰ dataSourceã€‘è¿™ä¸ª bean ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>é¦–å…ˆç¼–å†™æ¡ä»¶åˆ¤æ–­ç±»ï¼Œå®ƒå®ç° Condition æ¥å£ï¼Œç¼–å†™æ¡ä»¶åˆ¤æ–­é€»è¾‘</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> MyCondition1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> implements</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Condition</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">    // â¬‡ï¸å¦‚æœå­˜åœ¨ Druid ä¾èµ–ï¼Œæ¡ä»¶æˆç«‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> boolean</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> matches</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ConditionContext</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> context</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">AnnotatedTypeMetadata</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic"> metadata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> ClassUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">isPresent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"com.alibaba.druid.pool.DruidDataSource"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶æ¬¡ï¼Œåœ¨è¦å¯¼å…¥çš„è‡ªåŠ¨é…ç½®ç±»ä¸Šæ·»åŠ  <code v-pre>@Conditional(MyCondition1.class)</code>ï¼Œå°†æ¥æ­¤ç±»è¢«å¯¼å…¥æ—¶å°±ä¼šåšæ¡ä»¶æ£€æŸ¥</p>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Configuration</span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic"> // ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Conditional</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MyCondition1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">class</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75">) </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic">// â¬…ï¸åŠ å…¥æ¡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> AutoConfiguration1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B">Bean</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Bean1</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> bean1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Bean1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†åˆ«æµ‹è¯•åŠ å…¥å’Œå»é™¤ druid ä¾èµ–ï¼Œè§‚å¯Ÿ bean1 æ˜¯å¦å­˜åœ¨äºå®¹å™¨</p>
<div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>com.alibaba&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>druid&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>1.1.17&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ”¶è·ğŸ’¡-54" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-54"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å­¦ä¹ ä¸€ç§ç‰¹æ®Šçš„ if - else</li>
</ol>
<h2 id="å…¶å®ƒ" tabindex="-1"><a class="header-anchor" href="#å…¶å®ƒ"><span>å…¶å®ƒ</span></a></h2>
<h3 id="_43-factorybean" tabindex="-1"><a class="header-anchor" href="#_43-factorybean"><span>43) FactoryBean</span></a></h3>
<h4 id="æ¼”ç¤º-factorybean" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-factorybean"><span>æ¼”ç¤º - FactoryBean</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-40" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-40"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a43</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-55" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-55"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>å®ƒçš„ä½œç”¨æ˜¯ç”¨åˆ¶é€ åˆ›å»ºè¿‡ç¨‹è¾ƒä¸ºå¤æ‚çš„äº§å“, å¦‚ SqlSessionFactory, ä½† @Bean å·²å…·å¤‡ç­‰ä»·åŠŸèƒ½</li>
<li>ä½¿ç”¨ä¸Šè¾ƒä¸ºå¤æ€ª, ä¸€ä¸ç•™ç¥å°±ä¼šç”¨é”™
<ol>
<li>è¢« FactoryBean åˆ›å»ºçš„äº§å“
<ul>
<li>ä¼šè®¤ä¸ºåˆ›å»ºã€ä¾èµ–æ³¨å…¥ã€Aware æ¥å£å›è°ƒã€å‰åˆå§‹åŒ–è¿™äº›éƒ½æ˜¯ FactoryBean çš„èŒè´£, è¿™äº›æµç¨‹éƒ½ä¸ä¼šèµ°</li>
<li>å”¯æœ‰ååˆå§‹åŒ–çš„æµç¨‹ä¼šèµ°, ä¹Ÿå°±æ˜¯äº§å“å¯ä»¥è¢«ä»£ç†å¢å¼º</li>
<li>å•ä¾‹çš„äº§å“ä¸ä¼šå­˜å‚¨äº BeanFactory çš„ singletonObjects æˆå‘˜ä¸­, è€Œæ˜¯å¦ä¸€ä¸ª factoryBeanObjectCache æˆå‘˜ä¸­</li>
</ul>
</li>
<li>æŒ‰åå­—å»è·å–æ—¶, æ‹¿åˆ°çš„æ˜¯äº§å“å¯¹è±¡, åå­—å‰é¢åŠ  &amp; è·å–çš„æ˜¯å·¥å‚å¯¹è±¡</li>
</ol>
</li>
</ol>
<h3 id="_44-indexed-åŸç†" tabindex="-1"><a class="header-anchor" href="#_44-indexed-åŸç†"><span>44) @Indexed åŸç†</span></a></h3>
<p>çœŸå®é¡¹ç›®ä¸­ï¼Œåªéœ€è¦åŠ å…¥ä»¥ä¸‹ä¾èµ–å³å¯</p>
<div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>org.springframework&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>spring-context-indexer&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    &#x3C;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">optional</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">>true&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">optional</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&#x3C;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">></span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¼”ç¤º-indexed" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-indexed"><span>æ¼”ç¤º - @Indexed</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-41" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-41"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a44</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-56" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-56"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>åœ¨ç¼–è¯‘æ—¶å°±æ ¹æ® @Indexed ç”Ÿæˆ META-INF/spring.components æ–‡ä»¶</li>
<li>æ‰«ææ—¶
<ul>
<li>å¦‚æœå‘ç° META-INF/spring.components å­˜åœ¨, ä»¥å®ƒä¸ºå‡†åŠ è½½ bean definition</li>
<li>å¦åˆ™, ä¼šéå†åŒ…ä¸‹æ‰€æœ‰ class èµ„æº (åŒ…æ‹¬ jar å†…çš„)</li>
</ul>
</li>
<li>è§£å†³çš„é—®é¢˜ï¼Œåœ¨ç¼–è¯‘æœŸå°±æ‰¾åˆ° @Component ç»„ä»¶ï¼ŒèŠ‚çœè¿è¡ŒæœŸé—´æ‰«æ @Component çš„æ—¶é—´</li>
</ol>
<h3 id="_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£" tabindex="-1"><a class="header-anchor" href="#_45-ä»£ç†è¿›ä¸€æ­¥ç†è§£"><span>45) ä»£ç†è¿›ä¸€æ­¥ç†è§£</span></a></h3>
<h4 id="æ¼”ç¤º-ä»£ç†" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-ä»£ç†"><span>æ¼”ç¤º - ä»£ç†</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-42" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-42"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a45</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-57" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-57"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>
<p>spring ä»£ç†çš„è®¾è®¡ç‰¹ç‚¹</p>
<ul>
<li>
<p>ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å½±å“çš„æ˜¯åŸå§‹å¯¹è±¡</p>
<ul>
<li>å› æ­¤ cglib ä¸èƒ½ç”¨ MethodProxy.invokeSuper()</li>
</ul>
</li>
<li>
<p>ä»£ç†ä¸ç›®æ ‡æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼ŒäºŒè€…æˆå‘˜å˜é‡å¹¶ä¸å…±ç”¨æ•°æ®</p>
</li>
</ul>
</li>
<li>
<p>static æ–¹æ³•ã€final æ–¹æ³•ã€private æ–¹æ³•å‡æ— æ³•å¢å¼º</p>
<ul>
<li>è¿›ä¸€æ­¥ç†è§£ä»£ç†å¢å¼ºåŸºäºæ–¹æ³•é‡å†™</li>
</ul>
</li>
</ol>
<h3 id="_46-value-è£…é…åº•å±‚" tabindex="-1"><a class="header-anchor" href="#_46-value-è£…é…åº•å±‚"><span>46) @Value è£…é…åº•å±‚</span></a></h3>
<h4 id="æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤"><span>æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤</span></a></h4>
<ol>
<li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Optionalï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆéå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li>
<li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º ObjectFactory æˆ– ObjectProviderï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li>
<li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹ï¼ˆæˆå‘˜æˆ–å‚æ•°ï¼‰ä¸Šæ˜¯å¦ç”¨ @Lazy ä¿®é¥°ï¼Œæ˜¯ï¼Œåˆ™è¿”å›ä»£ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li>
<li>è§£æ @Value çš„å€¼
<ol>
<li>å¦‚æœéœ€è¦çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œå…ˆè§£æ ${ }ï¼Œå†è§£æ #</li>
<li>ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨ TypeConverter è½¬æ¢</li>
</ol>
</li>
<li>çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Streamã€Arrayã€Collectionã€Mapï¼Œæ˜¯ï¼Œåˆ™æŒ‰é›†åˆå¤„ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li>
<li>åœ¨ BeanFactory çš„ resolvableDependencies ä¸­æ‰¾æœ‰æ²¡æœ‰ç±»å‹åˆé€‚çš„å¯¹è±¡æ³¨å…¥ï¼Œæ²¡æœ‰å‘ä¸‹èµ°</li>
<li>åœ¨ BeanFactory åŠçˆ¶å·¥å‚ä¸­æ‰¾ç±»å‹åŒ¹é…çš„ bean è¿›è¡Œç­›é€‰ï¼Œç­›é€‰æ—¶ä¼šè€ƒè™‘ @Qualifier åŠæ³›å‹</li>
<li>ç»“æœä¸ªæ•°ä¸º 0 æŠ›å‡º NoSuchBeanDefinitionException å¼‚å¸¸</li>
<li>å¦‚æœç»“æœ &gt; 1ï¼Œå†æ ¹æ® @Primary è¿›è¡Œç­›é€‰</li>
<li>å¦‚æœç»“æœä» &gt; 1ï¼Œå†æ ¹æ®æˆå‘˜åæˆ–å˜é‡åè¿›è¡Œç­›é€‰</li>
<li>ç»“æœä» &gt; 1ï¼ŒæŠ›å‡º NoUniqueBeanDefinitionException å¼‚å¸¸</li>
</ol>
<h4 id="æ¼”ç¤º-value-è£…é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-value-è£…é…è¿‡ç¨‹"><span>æ¼”ç¤º - @Value è£…é…è¿‡ç¨‹</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-43" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-43"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a46</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-58" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-58"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>ContextAnnotationAutowireCandidateResolver ä½œç”¨ä¹‹ä¸€ï¼Œè·å– @Value çš„å€¼</li>
<li>äº†è§£ ${ } å¯¹åº”çš„è§£æå™¨</li>
<li>äº†è§£ #{ } å¯¹åº”çš„è§£æå™¨</li>
<li>TypeConvert çš„ä¸€é¡¹ä½“ç°</li>
</ol>
<h3 id="_47-autowired-è£…é…åº•å±‚" tabindex="-1"><a class="header-anchor" href="#_47-autowired-è£…é…åº•å±‚"><span>47) @Autowired è£…é…åº•å±‚</span></a></h3>
<h4 id="æ¼”ç¤º-autowired-è£…é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-autowired-è£…é…è¿‡ç¨‹"><span>æ¼”ç¤º - @Autowired è£…é…è¿‡ç¨‹</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-44" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-44"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a47</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-59" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-59"><span>æ”¶è·ğŸ’¡</span></a></h4>
<ol>
<li>@Autowired æœ¬è´¨ä¸Šæ˜¯æ ¹æ®æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°çš„ç±»å‹è¿›è¡Œè£…é…</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Optionalï¼Œéœ€è¦æ ¹æ® Optional æ³›å‹æ‰¾åˆ° beanï¼Œå†å°è£…ä¸º Optional å¯¹è±¡è£…é…</li>
<li>å¦‚æœå¾…è£…é…çš„ç±»å‹æ˜¯ ObjectFactoryï¼Œéœ€è¦æ ¹æ® ObjectFactory æ³›å‹åˆ›å»º ObjectFactory å¯¹è±¡è£…é…
<ul>
<li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿Ÿ bean çš„è·å–</li>
</ul>
</li>
<li>å¦‚æœå¾…è£…é…çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°ä¸Šç”¨ @Lazy æ ‡æ³¨ï¼Œä¼šåˆ›å»ºä»£ç†å¯¹è±¡è£…é…
<ul>
<li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿ŸçœŸå® bean çš„è·å–</li>
<li>è¢«è£…é…çš„ä»£ç†ä¸ä½œä¸º bean</li>
</ul>
</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯æ•°ç»„ï¼Œéœ€è¦è·å–æ•°ç»„å…ƒç´ ç±»å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean è¿›è¡Œè£…é…</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Collection æˆ–å…¶å­æ¥å£ï¼Œéœ€è¦è·å– Collection æ³›å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ ApplicationContext ç­‰ç‰¹æ®Šç±»å‹
<ul>
<li>ä¼šåœ¨ BeanFactory çš„ resolvableDependencies æˆå‘˜æŒ‰ç±»å‹æŸ¥æ‰¾è£…é…</li>
<li>resolvableDependencies æ˜¯ map é›†åˆï¼Œkey æ˜¯ç‰¹æ®Šç±»å‹ï¼Œvalue æ˜¯å…¶å¯¹åº”å¯¹è±¡</li>
<li>ä¸èƒ½ç›´æ¥æ ¹æ® key è¿›è¡ŒæŸ¥æ‰¾ï¼Œè€Œæ˜¯ç”¨ isAssignableFrom é€ä¸€å°è¯•å³è¾¹ç±»å‹æ˜¯å¦å¯ä»¥è¢«èµ‹å€¼ç»™å·¦è¾¹çš„ key ç±»å‹</li>
</ul>
</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰æ³›å‹å‚æ•°
<ul>
<li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³›å‹å‚æ•°ç±»å‹ç­›é€‰</li>
</ul>
</li>
<li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰ @Qualifier
<ul>
<li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³¨è§£æä¾›çš„ bean åç§°ç­›é€‰</li>
</ul>
</li>
<li>æœ‰ @Primary æ ‡æ³¨çš„ @Component æˆ– @Bean çš„å¤„ç†</li>
<li>ä¸æˆå‘˜å˜é‡åæˆ–æ–¹æ³•å‚æ•°ååŒå bean çš„å¤„ç†</li>
</ol>
<h3 id="_48-äº‹ä»¶ç›‘å¬å™¨" tabindex="-1"><a class="header-anchor" href="#_48-äº‹ä»¶ç›‘å¬å™¨"><span>48) äº‹ä»¶ç›‘å¬å™¨</span></a></h3>
<h4 id="æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨"><span>æ¼”ç¤º - äº‹ä»¶ç›‘å¬å™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-45" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-45"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a48</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-60" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-60"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>äº‹ä»¶ç›‘å¬å™¨çš„ä¸¤ç§æ–¹å¼</p>
<ol>
<li>å®ç° ApplicationListener æ¥å£
<ul>
<li>æ ¹æ®æ¥å£æ³›å‹ç¡®å®šäº‹ä»¶ç±»å‹</li>
</ul>
</li>
<li>@EventListener æ ‡æ³¨ç›‘å¬æ–¹æ³•
<ul>
<li>æ ¹æ®ç›‘å¬å™¨æ–¹æ³•å‚æ•°ç¡®å®šäº‹ä»¶ç±»å‹</li>
<li>è§£ææ—¶æœºï¼šåœ¨ SmartInitializingSingletonï¼ˆæ‰€æœ‰å•ä¾‹åˆå§‹åŒ–å®Œæˆåï¼‰ï¼Œè§£ææ¯ä¸ªå•ä¾‹ bean</li>
</ul>
</li>
</ol>
<h3 id="_49-äº‹ä»¶å‘å¸ƒå™¨" tabindex="-1"><a class="header-anchor" href="#_49-äº‹ä»¶å‘å¸ƒå™¨"><span>49) äº‹ä»¶å‘å¸ƒå™¨</span></a></h3>
<h4 id="æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨" tabindex="-1"><a class="header-anchor" href="#æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨"><span>æ¼”ç¤º - äº‹ä»¶å‘å¸ƒå™¨</span></a></h4>
<h5 id="ä»£ç å‚è€ƒ-46" tabindex="-1"><a class="header-anchor" href="#ä»£ç å‚è€ƒ-46"><span>ä»£ç å‚è€ƒ</span></a></h5>
<p><strong>com.itheima.a49</strong> åŒ…</p>
<h4 id="æ”¶è·ğŸ’¡-61" tabindex="-1"><a class="header-anchor" href="#æ”¶è·ğŸ’¡-61"><span>æ”¶è·ğŸ’¡</span></a></h4>
<p>äº‹ä»¶å‘å¸ƒå™¨æ¨¡æ‹Ÿå®ç°</p>
<ol>
<li>addApplicationListenerBean è´Ÿè´£æ”¶é›†å®¹å™¨ä¸­çš„ç›‘å¬å™¨
<ul>
<li>ç›‘å¬å™¨ä¼šç»Ÿä¸€è½¬æ¢ä¸º GenericApplicationListener å¯¹è±¡ï¼Œä»¥æ”¯æŒåˆ¤æ–­äº‹ä»¶ç±»å‹</li>
</ul>
</li>
<li>multicastEvent éå†ç›‘å¬å™¨é›†åˆï¼Œå‘å¸ƒäº‹ä»¶
<ul>
<li>å‘å¸ƒå‰å…ˆé€šè¿‡ GenericApplicationListener.supportsEventType åˆ¤æ–­æ”¯æŒè¯¥äº‹ä»¶ç±»å‹æ‰å‘äº‹ä»¶</li>
<li>å¯ä»¥åˆ©ç”¨çº¿ç¨‹æ± è¿›è¡Œå¼‚æ­¥å‘äº‹ä»¶ä¼˜åŒ–</li>
</ul>
</li>
<li>å¦‚æœå‘é€çš„äº‹ä»¶å¯¹è±¡ä¸æ˜¯ ApplicationEvent ç±»å‹ï¼ŒSpring ä¼šæŠŠå®ƒåŒ…è£…ä¸º PayloadApplicationEvent å¹¶ç”¨æ³›å‹æŠ€æœ¯è§£æäº‹ä»¶å¯¹è±¡çš„åŸå§‹ç±»å‹
<ul>
<li>è§†é¢‘ä¸­æœªè®²è§£</li>
</ul>
</li>
</ol>
</div></template>


